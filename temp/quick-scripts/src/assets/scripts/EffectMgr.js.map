{"version":3,"sources":["assets\\scripts\\EffectMgr.js"],"names":["t","require","e","module","o","exports","Object","defineProperty","value","a","i","r","n","s","playEff","c","l","u","p","g","PoolMgr","getInstance","getNode","cc","isValid","parent","setPosition","v2","x","y","zIndex","getComponent","sp","Skeleton","setAnimation","setCompleteListener","recycleNodeEff","console","log","ResourceMgr","loadRes","Prefab","instantiate","playEffectForEffId","d","h","DataMgr","getEffectCfg","f","effName","m","Utils","posTransform","getPosition","isDestroy","bundleName","pathName","type","isLoop","playCount","Animation","play","repeatCount","on","EventType","FINISHED","name","defaultAnimation","playTime","tween","delay","call","start","freeNode"],"mappings":"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","sourceRoot":"/","sourcesContent":["var t = require;\nvar e = module;\nvar o = exports;\nObject.defineProperty(o, \"__esModule\", {\n    value: !0\n});\nvar a = t(\"PoolMgr\"),\ni = t(\"ResourceMgr\"),\nr = t(\"Utils\"),\nn = t(\"DataMgr\"),\ns = function() {\n    function t() {}\n    return t.playEff = function(t, e, o, r, n, s, c, l, u) {\n        var p = this;\n        if (void 0 === c && (c = 0), void 0 === l && (l = 0), void 0 === u && (u = 0), r) {\n            var g = a.PoolMgr.getInstance().getNode(o);\n            g ? (cc.isValid(n) && (g.parent = n), s && g.setPosition(cc.v2(s.x, s.y + c)), g.zIndex = u, g.getComponent(sp.Skeleton).setAnimation(0, r, !1), g.getComponent(sp.Skeleton).setCompleteListener(function() {\n                p.recycleNodeEff(g, o)\n            })) : (console.log(\"动态加载\"), i.ResourceMgr.getInstance().loadRes(t, e, cc.Prefab,\n            function(t) {\n                g = cc.instantiate(t),\n                cc.isValid(n) && (g.parent = n),\n                s && g.setPosition(cc.v2(s.x, s.y + c)),\n                g.zIndex = u,\n                g.getComponent(sp.Skeleton).setCompleteListener(function() {\n                    p.recycleNodeEff(g, o)\n                })\n            }))\n        }\n    },\n    t.playEffectForEffId = function(t, e, o, s, c, l, u, p, g) {\n        var d = this;\n        void 0 === o && (o = null),\n        void 0 === s && (s = 0),\n        void 0 === c && (c = 0),\n        void 0 === l && (l = 0),\n        void 0 === u && (u = 1),\n        void 0 === p && (p = 1),\n        void 0 === g && (g = function() {});\n        var h = n.DataMgr.getInstance().getEffectCfg(t),\n        f = a.PoolMgr.getInstance().getNode(h.effName);\n        if (f) {\n            f.parent = e,\n            f.zIndex = l;\n            var m = cc.v2();\n            cc.isValid(o) && (m = r.Utils.posTransform(o.parent, o.getPosition(), e)),\n            f.setPosition(cc.v2(m.x + s, m.y + c)),\n            this.isDestroy(f, h)\n        } else i.ResourceMgr.getInstance().loadRes(h.bundleName, h.pathName, cc.Prefab,\n        function(t) { (f = cc.instantiate(t)).parent = e,\n            f.zIndex = l;\n            var a = cc.v2();\n            cc.isValid(o) && (a = r.Utils.posTransform(o.parent, o.getPosition(), e)),\n            f.setPosition(cc.v2(a.x + s, a.y + c)),\n            d.isDestroy(f, h)\n        })\n    },\n    t.isDestroy = function(t, e) {\n        var o = this;\n        switch (e.type) {\n            case 1:\n                var a = 1;\n            1 == e.isLoop ? a = 1e4: e.playCount && (a = e.playCount);\n            var i = t.getComponent(cc.Animation);\n            i.play().repeatCount = a,\n            i.on(cc.Animation.EventType.FINISHED,\n            function() {\n                o.recycleNodeEff(t, t.name)\n            });\n            break;\n            case 2:\n                var r = !1;\n            1 == e.isLoop && (r = !0);\n            var n = t.getComponent(sp.Skeleton);\n            n.setAnimation(0, n.defaultAnimation, r),\n            n.setCompleteListener(function() {\n                o.recycleNodeEff(t, t.name)\n            });\n            break;\n            default: if (1 == e.isLoop) break;\n            var s = 1;\n            e.playTime && (s = e.playTime),\n            cc.tween(t).delay(s).call(function() {\n                o.recycleNodeEff(t, t.name)\n            }).start();\n        }\n    },\n    t.recycleNodeEff = function(t, e) {\n        cc.isValid(t) && a.PoolMgr.getInstance().freeNode(e, t)\n    },\n    t\n} ();\no.default = s"]}