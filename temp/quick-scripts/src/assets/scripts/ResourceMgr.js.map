{"version":3,"sources":["assets\\scripts\\ResourceMgr.js"],"names":["t","require","e","module","o","exports","Object","defineProperty","value","ResourceMgr","BundleCache","ResCacheKey","ResCache","a","i","r","n","s","c","l","releaseTime","cacheTime","asset","type","cc","js","getClassName","cachekey","defCount","lifeTime","createTime","TimeUtils","GetTimeBySecond","canRelease","prototype","setLifeTime","bundleName","dateTime","u","getInstance","instance","getBundle","assetManager","loadBundle","LogMgr","error","debug","preloadFromBundle","preload","Asset","relLoadBundle","get","load","length","loadFromRes","loadRes","loadDirFrom","loadDir","loadSpriteframe","ArgsParseUtils","_makeloadSpriteFrameResrgs","apply","arguments","bundle","path","callback","saveKey","p","g","ResCacheMgr","getAssets","SpriteFrame","addRef","d","h","cacheTme","message","addAssets","autoRelese","addAssetKeyToMap","loadRemoteSpriteFrame","Texture2D","startsWith","PlatformManager","currentPlatform","Platform","BYTEDANCE","loadRemote","ext","_makeLoadResArgs","f","console","releaseByBundle","release","releaseByBname","releaseBundle","removeBundle"],"mappings":"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","sourceRoot":"/","sourcesContent":["var t = require;\nvar e = module;\nvar o = exports;\nObject.defineProperty(o, \"__esModule\", {\n    value: !0\n}),\no.ResourceMgr = o.BundleCache = o.ResCacheKey = o.ResCache = void 0;\nvar a = t(\"BasePlatform\"),\ni = t(\"ArgsParseUtils\"),\nr = t(\"TimeUtils\"),\nn = t(\"LogMgr\"),\ns = t(\"PlatformManager\"),\nc = t(\"ResCacheMgr\"),\nl = function() {\n    function t(t, e, o, a, i, n) {\n        this.releaseTime = o,\n        this.cacheTime = a,\n        this.asset = n,\n        this.type = cc.js.getClassName(i),\n        this.cachekey = t + \"/\" + e,\n        this.defCount = 0,\n        this.lifeTime = 3,\n        this.createTime = r.TimeUtils.GetTimeBySecond(),\n        this.canRelease = !0\n    }\n    return t.prototype.setLifeTime = function(t) {\n        this.lifeTime = t\n    },\n    t\n} ();\no.ResCache = l;\no.ResCacheKey = function(t, e, o) {\n    this.defCount = 0,\n    this.type = cc.js.getClassName(o),\n    this.cachekey = t + \"/\" + e,\n    this.defCount = 1\n};\no.BundleCache = function(t, e, o) {\n    this.bundleName = t,\n    this.dateTime = e,\n    this.cacheTime = o\n};\nvar u = function() {\n    function t() {}\n    return t.getInstance = function() {\n        return null == this.instance && (this.instance = new t),\n        this.instance\n    },\n    t.prototype.getBundle = function(t) {\n        return cc.assetManager.getBundle(t)\n    },\n    t.prototype.loadBundle = function(t, e) {\n        var o = cc.assetManager.getBundle(t);\n        null == o ? cc.assetManager.loadBundle(t,\n        function(o, a) {\n            o ? n.LogMgr.getInstance().error(t + \"bundle load error :\" + o) : (n.LogMgr.getInstance().debug(\"加载bundle:\" + t), e(a))\n        }) : e(o)\n    },\n    t.prototype.preloadFromBundle = function(t, e, o) {\n        t.preload(e, cc.Asset,\n        function(t, e) {\n            o && o(t, e)\n        })\n    },\n    t.prototype.preload = function(t, e) {\n        var o = cc.assetManager.getBundle(t);\n        o ? e && o.preload(e) : cc.assetManager.loadBundle(t,\n        function(t, o) {\n            t || e && o.preload(e)\n        })\n    },\n    t.prototype.relLoadBundle = function(t, e) {\n        for (var o = function(o) {\n            var i = t[o];\n            a.loadBundle(i,\n            function(t) {\n                if (e) {\n                    var a = e.get(o);\n                    t.load(a)\n                }\n            })\n        },\n        a = this, i = 0; i < t.length; i++) o(i)\n    },\n    t.prototype.loadFromRes = function(t, e, o) {\n        this.loadRes(\"resources\", t, e, o)\n    },\n    t.prototype.loadDirFrom = function(t, e) {\n        this.loadDir(\"resources\", t, e)\n    },\n    t.prototype.loadSpriteframe = function() {\n        var e = i.ArgsParseUtils._makeloadSpriteFrameResrgs.apply(this, arguments),\n        o = e.bundle,\n        a = e.path,\n        s = e.callback,\n        u = e.saveKey,\n        p = r.TimeUtils.GetTimeBySecond() + 86400,\n        g = c.ResCacheMgr.getInstance().getAssets(o, a, cc.SpriteFrame);\n        if (g && g.asset) return g.asset.addRef(),\n        g.cacheTime = p,\n        void s(g.asset);\n        var d = cc.assetManager.getBundle(o),\n        h = new l(o, a, p, e.cacheTme, cc.SpriteFrame);\n        null == d ? t.getInstance().loadBundle(o,\n        function(t) {\n            t.load(a, cc.SpriteFrame,\n            function(t, i) {\n                t ? n.LogMgr.getInstance().error(\"loadres error path:\" + a + \"  error:\", t.message) : (i.addRef(), h.asset = i, c.ResCacheMgr.getInstance().addAssets(h, e.autoRelese), u && c.ResCacheMgr.getInstance().addAssetKeyToMap(u, o, a, cc.SpriteFrame), s && s(i))\n            })\n        }) : d.load(a, cc.SpriteFrame,\n        function(t, i) {\n            t ? n.LogMgr.getInstance().error(\"loadres error path:\" + a + \"  error:\" + t) : (i.addRef(), h.asset = i, c.ResCacheMgr.getInstance().addAssets(h, e.autoRelese), u && c.ResCacheMgr.getInstance().addAssetKeyToMap(u, o, a, cc.SpriteFrame), s && s(i))\n        })\n    },\n    t.prototype.loadRemoteSpriteFrame = function(t, e, o, i) {\n        void 0 === o && (o = !1),\n        void 0 === i && (i = 10);\n        var n = r.TimeUtils.GetTimeBySecond() + 86400,\n        u = c.ResCacheMgr.getInstance().getAssets(\"\", t, cc.Texture2D);\n        if (u && u.asset) return u.asset.addRef(),\n        void e(u.asset);\n        var p = new l(\"\", t, n, i, cc.Texture2D);\n        t.startsWith(\"http\") && (s.PlatformManager.currentPlatform == a.Platform.BYTEDANCE ? cc.assetManager.loadRemote(t, {\n            ext: \".head\"\n        },\n        function(t, a) {\n            if (!t) {\n                a.addRef(),\n                p.asset = a,\n                c.ResCacheMgr.getInstance().addAssets(p, o);\n                var i = new cc.SpriteFrame(a);\n                e(i)\n            }\n        }) : cc.assetManager.loadRemote(t,\n        function(t, a) {\n            if (!t) {\n                a.addRef(),\n                p.asset = a,\n                c.ResCacheMgr.getInstance().addAssets(p, o);\n                var i = new cc.SpriteFrame(a);\n                e(i)\n            }\n        }))\n    },\n    t.prototype.loadRes = function() {\n        var e = i.ArgsParseUtils._makeLoadResArgs.apply(this, arguments),\n        o = e.bundle,\n        a = e.path,\n        s = e.type,\n        u = e.callback,\n        p = e.saveKey;\n        if (\"cc.Asset\" != cc.js.getClassName(s)) {\n            var g = r.TimeUtils.GetTimeBySecond() + 86400,\n            d = c.ResCacheMgr.getInstance().getAssets(o, a, s);\n            if (d && d.asset) return d.asset.addRef(),\n            void u(d.asset);\n            var h = cc.assetManager.getBundle(o),\n            f = new l(o, a, g, e.cacheTme, s);\n            null == h ? t.getInstance().loadBundle(o,\n            function(t) {\n                t.load(a, s,\n                function(t, i) {\n                    t ? n.LogMgr.getInstance().error(\"loadres error path:\" + a + \"  error:\", t.message) : (i.addRef(), f.asset = i, c.ResCacheMgr.getInstance().addAssets(f, e.autoRelese), p && c.ResCacheMgr.getInstance().addAssetKeyToMap(p, o, a, s), u && u(i))\n                })\n            }) : h.load(a, s,\n            function(t, i) {\n                t ? n.LogMgr.getInstance().error(\"loadres error path:\" + a + \"  error:\" + t) : (i.addRef(), f.asset = i, c.ResCacheMgr.getInstance().addAssets(f, e.autoRelese), p && c.ResCacheMgr.getInstance().addAssetKeyToMap(p, o, a, s), u && u(i))\n            })\n        } else console.error(\"请传入具体资源类型，不能是基类asset,路径:\", o + \"/\" + a)\n    },\n    t.prototype.loadDir = function(t, e, o) {\n        var a = cc.assetManager.getBundle(t);\n        null == a ? cc.assetManager.loadBundle(t,\n        function(t, a) {\n            a.loadDir(e, cc.Asset,\n            function(t, a) {\n                t ? n.LogMgr.getInstance().error(\"loadres error path:\" + e + \"  error:\" + t) : o && o(a)\n            })\n        }) : a.loadDir(e, cc.Asset,\n        function(t, a) {\n            t ? n.LogMgr.getInstance().error(\"loadres error path:\" + e + \"  error:\" + t) : o && o(a)\n        })\n    },\n    t.prototype.releaseByBundle = function(t, e) {\n        t.release(e)\n    },\n    t.prototype.releaseByBname = function(t, e) {\n        var o = cc.assetManager.getBundle(t);\n        o && o.release(e)\n    },\n    t.prototype.releaseBundle = function(t) {\n        var e = cc.assetManager.getBundle(t);\n        e && cc.assetManager.removeBundle(e)\n    },\n    t.instance = null,\n    t\n} ();\no.ResourceMgr = u"]}