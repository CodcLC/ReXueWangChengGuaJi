
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/RedDotMgr.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'ef426Z2ct1F3ZCWNPS55T4T', 'RedDotMgr');
// scripts/RedDotMgr.js

"use strict";

var t = require;
var e = module;
var o = exports;
Object.defineProperty(o, "__esModule", {
  value: !0
});

var a = t("TimeUtils"),
    i = t("Config"),
    r = t("DataMgr"),
    n = t("EquipMgr"),
    s = t("PlayerMgr"),
    c = function () {
  function t() {}

  return t.getInstance = function () {
    return null == this.instance && (this.instance = new t()), this.instance;
  }, t.prototype.homeForRedDot = function (t, e, o, a, i) {
    this.taskForRedDot(t), this.onHookForRedDot(e), this.skillBookForRedDot(o), this.equipForRedDot(a), this.shopForRedDot(i);
  }, t.prototype.taskForRedDot = function (t) {
    for (var e = s.PlayerMgr.getInstance().geUserData().getCurTaskList(), o = 0; o < e.length; o++) {
      if (1 == e[o].state) return cc.isValid(t) && (t.active = !0), !0;
    }

    return cc.isValid(t) && (t.active = !1), !1;
  }, t.prototype.onHookForRedDot = function (t) {
    var e = s.PlayerMgr.getInstance().geUserData();
    return a.TimeUtils.timeExchange(1, e.getOnHookTime()) > Number(r.DataMgr.getInstance().getParamsCfgForSingle(i.EnumParams.OnHookMaxTime).value) ? (cc.isValid(t) && (t.active = !0), !0) : (cc.isValid(t) && (t.active = !1), !1);
  }, t.prototype.skillBookForRedDot = function (t) {
    for (var e = s.PlayerMgr.getInstance().geUserData(), o = e.getSkillBookArr(), a = 0; a < o.length; a++) {
      var i = r.DataMgr.getInstance().getSkillBookLevelCfg(o[a].id, o[a].level);
      if (o[a].iCount >= i.ConsumeSkillBookNum && e.getGoldNum() >= i.ConsumeNum) return cc.isValid(t) && (t.active = !0), !0;
    }

    return cc.isValid(t) && (t.active = !1), !1;
  }, t.prototype.equipForRedDot = function (t) {
    for (var e = s.PlayerMgr.getInstance().geUserData(), o = e.getOwnedEquipList(), a = 0; a < o.length; a++) {
      for (var i = e.isExistEquip(a + 1), c = 0; c < o[a].length; c++) {
        var l = o[a][c];
        if (!i) return cc.isValid(t) && (t.active = !0), !0;
        var u = 0,
            p = 0,
            g = s.PlayerMgr.getInstance().getAbType();
        if ("D" == g || "B" == g ? (u = n["default"].getInstance().getEquipFightForId(l.id, !1, l.type, l.IDCard, l), p = n["default"].getInstance().getEquipFightForId(i.id, !1, i.type, i.IDCard, i)) : (u = r.DataMgr.getInstance().getEquipStrengthenCfg(l.id, l.strengthenLv).fightNum, p = r.DataMgr.getInstance().getEquipStrengthenCfg(i.id, i.strengthenLv).fightNum), u > p) return cc.isValid(t) && (t.active = !0), !0;
      }
    }

    return cc.isValid(t) && (t.active = !1), !1;
  }, t.prototype.shopForRedDot = function (t) {
    return s.PlayerMgr.getInstance().geUserData().getInGotNum() >= 100 ? (cc.isValid(t) && (t.active = !0), !0) : (cc.isValid(t) && (t.active = !1), !1);
  }, t;
}();

o["default"] = c;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcUmVkRG90TWdyLmpzIl0sIm5hbWVzIjpbInQiLCJyZXF1aXJlIiwiZSIsIm1vZHVsZSIsIm8iLCJleHBvcnRzIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsImEiLCJpIiwiciIsIm4iLCJzIiwiYyIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJwcm90b3R5cGUiLCJob21lRm9yUmVkRG90IiwidGFza0ZvclJlZERvdCIsIm9uSG9va0ZvclJlZERvdCIsInNraWxsQm9va0ZvclJlZERvdCIsImVxdWlwRm9yUmVkRG90Iiwic2hvcEZvclJlZERvdCIsIlBsYXllck1nciIsImdlVXNlckRhdGEiLCJnZXRDdXJUYXNrTGlzdCIsImxlbmd0aCIsInN0YXRlIiwiY2MiLCJpc1ZhbGlkIiwiYWN0aXZlIiwiVGltZVV0aWxzIiwidGltZUV4Y2hhbmdlIiwiZ2V0T25Ib29rVGltZSIsIk51bWJlciIsIkRhdGFNZ3IiLCJnZXRQYXJhbXNDZmdGb3JTaW5nbGUiLCJFbnVtUGFyYW1zIiwiT25Ib29rTWF4VGltZSIsImdldFNraWxsQm9va0FyciIsImdldFNraWxsQm9va0xldmVsQ2ZnIiwiaWQiLCJsZXZlbCIsImlDb3VudCIsIkNvbnN1bWVTa2lsbEJvb2tOdW0iLCJnZXRHb2xkTnVtIiwiQ29uc3VtZU51bSIsImdldE93bmVkRXF1aXBMaXN0IiwiaXNFeGlzdEVxdWlwIiwibCIsInUiLCJwIiwiZyIsImdldEFiVHlwZSIsImdldEVxdWlwRmlnaHRGb3JJZCIsInR5cGUiLCJJRENhcmQiLCJnZXRFcXVpcFN0cmVuZ3RoZW5DZmciLCJzdHJlbmd0aGVuTHYiLCJmaWdodE51bSIsImdldEluR290TnVtIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUMsR0FBR0MsT0FBUjtBQUNBLElBQUlDLENBQUMsR0FBR0MsTUFBUjtBQUNBLElBQUlDLENBQUMsR0FBR0MsT0FBUjtBQUNBQyxNQUFN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QUFZVSxDQUFaIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdCA9IHJlcXVpcmU7XG52YXIgZSA9IG1vZHVsZTtcbnZhciBvID0gZXhwb3J0cztcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiAhMFxufSk7XG52YXIgYSA9IHQoXCJUaW1lVXRpbHNcIiksXG5pID0gdChcIkNvbmZpZ1wiKSxcbnIgPSB0KFwiRGF0YU1nclwiKSxcbm4gPSB0KFwiRXF1aXBNZ3JcIiksXG5zID0gdChcIlBsYXllck1nclwiKSxcbmMgPSBmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiB0KCkge31cbiAgICByZXR1cm4gdC5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbnVsbCA9PSB0aGlzLmluc3RhbmNlICYmICh0aGlzLmluc3RhbmNlID0gbmV3IHQpLFxuICAgICAgICB0aGlzLmluc3RhbmNlXG4gICAgfSxcbiAgICB0LnByb3RvdHlwZS5ob21lRm9yUmVkRG90ID0gZnVuY3Rpb24odCwgZSwgbywgYSwgaSkge1xuICAgICAgICB0aGlzLnRhc2tGb3JSZWREb3QodCksXG4gICAgICAgIHRoaXMub25Ib29rRm9yUmVkRG90KGUpLFxuICAgICAgICB0aGlzLnNraWxsQm9va0ZvclJlZERvdChvKSxcbiAgICAgICAgdGhpcy5lcXVpcEZvclJlZERvdChhKSxcbiAgICAgICAgdGhpcy5zaG9wRm9yUmVkRG90KGkpXG4gICAgfSxcbiAgICB0LnByb3RvdHlwZS50YXNrRm9yUmVkRG90ID0gZnVuY3Rpb24odCkge1xuICAgICAgICBmb3IgKHZhciBlID0gcy5QbGF5ZXJNZ3IuZ2V0SW5zdGFuY2UoKS5nZVVzZXJEYXRhKCkuZ2V0Q3VyVGFza0xpc3QoKSwgbyA9IDA7IG8gPCBlLmxlbmd0aDsgbysrKSBpZiAoMSA9PSBlW29dLnN0YXRlKSByZXR1cm4gY2MuaXNWYWxpZCh0KSAmJiAodC5hY3RpdmUgPSAhMCksXG4gICAgICAgICEwO1xuICAgICAgICByZXR1cm4gY2MuaXNWYWxpZCh0KSAmJiAodC5hY3RpdmUgPSAhMSksXG4gICAgICAgICExXG4gICAgfSxcbiAgICB0LnByb3RvdHlwZS5vbkhvb2tGb3JSZWREb3QgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHZhciBlID0gcy5QbGF5ZXJNZ3IuZ2V0SW5zdGFuY2UoKS5nZVVzZXJEYXRhKCk7XG4gICAgICAgIHJldHVybiBhLlRpbWVVdGlscy50aW1lRXhjaGFuZ2UoMSwgZS5nZXRPbkhvb2tUaW1lKCkpID4gTnVtYmVyKHIuRGF0YU1nci5nZXRJbnN0YW5jZSgpLmdldFBhcmFtc0NmZ0ZvclNpbmdsZShpLkVudW1QYXJhbXMuT25Ib29rTWF4VGltZSkudmFsdWUpID8gKGNjLmlzVmFsaWQodCkgJiYgKHQuYWN0aXZlID0gITApLCAhMCkgOiAoY2MuaXNWYWxpZCh0KSAmJiAodC5hY3RpdmUgPSAhMSksICExKVxuICAgIH0sXG4gICAgdC5wcm90b3R5cGUuc2tpbGxCb29rRm9yUmVkRG90ID0gZnVuY3Rpb24odCkge1xuICAgICAgICBmb3IgKHZhciBlID0gcy5QbGF5ZXJNZ3IuZ2V0SW5zdGFuY2UoKS5nZVVzZXJEYXRhKCksIG8gPSBlLmdldFNraWxsQm9va0FycigpLCBhID0gMDsgYSA8IG8ubGVuZ3RoOyBhKyspIHtcbiAgICAgICAgICAgIHZhciBpID0gci5EYXRhTWdyLmdldEluc3RhbmNlKCkuZ2V0U2tpbGxCb29rTGV2ZWxDZmcob1thXS5pZCwgb1thXS5sZXZlbCk7XG4gICAgICAgICAgICBpZiAob1thXS5pQ291bnQgPj0gaS5Db25zdW1lU2tpbGxCb29rTnVtICYmIGUuZ2V0R29sZE51bSgpID49IGkuQ29uc3VtZU51bSkgcmV0dXJuIGNjLmlzVmFsaWQodCkgJiYgKHQuYWN0aXZlID0gITApLFxuICAgICAgICAgICAgITBcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2MuaXNWYWxpZCh0KSAmJiAodC5hY3RpdmUgPSAhMSksXG4gICAgICAgICExXG4gICAgfSxcbiAgICB0LnByb3RvdHlwZS5lcXVpcEZvclJlZERvdCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgZm9yICh2YXIgZSA9IHMuUGxheWVyTWdyLmdldEluc3RhbmNlKCkuZ2VVc2VyRGF0YSgpLCBvID0gZS5nZXRPd25lZEVxdWlwTGlzdCgpLCBhID0gMDsgYSA8IG8ubGVuZ3RoOyBhKyspIGZvciAodmFyIGkgPSBlLmlzRXhpc3RFcXVpcChhICsgMSksIGMgPSAwOyBjIDwgb1thXS5sZW5ndGg7IGMrKykge1xuICAgICAgICAgICAgdmFyIGwgPSBvW2FdW2NdO1xuICAgICAgICAgICAgaWYgKCFpKSByZXR1cm4gY2MuaXNWYWxpZCh0KSAmJiAodC5hY3RpdmUgPSAhMCksXG4gICAgICAgICAgICAhMDtcbiAgICAgICAgICAgIHZhciB1ID0gMCxcbiAgICAgICAgICAgIHAgPSAwLFxuICAgICAgICAgICAgZyA9IHMuUGxheWVyTWdyLmdldEluc3RhbmNlKCkuZ2V0QWJUeXBlKCk7XG4gICAgICAgICAgICBpZiAoXCJEXCIgPT0gZyB8fCBcIkJcIiA9PSBnID8gKHUgPSBuLmRlZmF1bHQuZ2V0SW5zdGFuY2UoKS5nZXRFcXVpcEZpZ2h0Rm9ySWQobC5pZCwgITEsIGwudHlwZSwgbC5JRENhcmQsIGwpLCBwID0gbi5kZWZhdWx0LmdldEluc3RhbmNlKCkuZ2V0RXF1aXBGaWdodEZvcklkKGkuaWQsICExLCBpLnR5cGUsIGkuSURDYXJkLCBpKSkgOiAodSA9IHIuRGF0YU1nci5nZXRJbnN0YW5jZSgpLmdldEVxdWlwU3RyZW5ndGhlbkNmZyhsLmlkLCBsLnN0cmVuZ3RoZW5MdikuZmlnaHROdW0sIHAgPSByLkRhdGFNZ3IuZ2V0SW5zdGFuY2UoKS5nZXRFcXVpcFN0cmVuZ3RoZW5DZmcoaS5pZCwgaS5zdHJlbmd0aGVuTHYpLmZpZ2h0TnVtKSwgdSA+IHApIHJldHVybiBjYy5pc1ZhbGlkKHQpICYmICh0LmFjdGl2ZSA9ICEwKSxcbiAgICAgICAgICAgICEwXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNjLmlzVmFsaWQodCkgJiYgKHQuYWN0aXZlID0gITEpLFxuICAgICAgICAhMVxuICAgIH0sXG4gICAgdC5wcm90b3R5cGUuc2hvcEZvclJlZERvdCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHMuUGxheWVyTWdyLmdldEluc3RhbmNlKCkuZ2VVc2VyRGF0YSgpLmdldEluR290TnVtKCkgPj0gMTAwID8gKGNjLmlzVmFsaWQodCkgJiYgKHQuYWN0aXZlID0gITApLCAhMCkgOiAoY2MuaXNWYWxpZCh0KSAmJiAodC5hY3RpdmUgPSAhMSksICExKVxuICAgIH0sXG4gICAgdFxufSAoKTtcbm8uZGVmYXVsdCA9IGMiXX0=