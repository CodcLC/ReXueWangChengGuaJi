
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/NodeEquipComposite.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'dbc4efhTYROkZBcivTYwC+N', 'NodeEquipComposite');
// scripts/NodeEquipComposite.js

"use strict";

var t = require;
var e = module;
var o = exports;

var _a,
    i = void 0 && (void 0).__extends || (_a = function a(t, e) {
  return (_a = Object.setPrototypeOf || {
    __proto__: []
  } instanceof Array && function (t, e) {
    t.__proto__ = e;
  } || function (t, e) {
    for (var o in e) {
      Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]);
    }
  })(t, e);
}, function (t, e) {
  function o() {
    this.constructor = t;
  }

  _a(t, e), t.prototype = null === e ? Object.create(e) : (o.prototype = e.prototype, new o());
}),
    r = void 0 && (void 0).__decorate || function (t, e, o, a) {
  var i,
      r = arguments.length,
      n = r < 3 ? e : null === a ? a = Object.getOwnPropertyDescriptor(e, o) : a;
  if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) n = Reflect.decorate(t, e, o, a);else for (var s = t.length - 1; s >= 0; s--) {
    (i = t[s]) && (n = (r < 3 ? i(n) : r > 3 ? i(e, o, n) : i(e, o)) || n);
  }
  return r > 3 && n && Object.defineProperty(e, o, n), n;
};

Object.defineProperty(o, "__esModule", {
  value: !0
});
var n = t("EventMgr"),
    s = t("UIMgr"),
    c = t("Config"),
    l = t("EquipMgr"),
    u = t("PlayerMgr"),
    p = cc._decorator,
    g = p.ccclass,
    d = (p.property, function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    return e.uiView = c.UIID.UIEquip, e.curBagIndex = 1, e.equipData = null, e;
  }

  return i(e, t), e.prototype.start = function () {}, e.prototype.registerBtnEvent = function () {
    var t = this;
    this.node.on(cc.Node.EventType.TOUCH_END, function () {
      t.node.getChildByName("SpMask").active || (t.equipData.starLevel >= 5 ? s.UIMgr.getInstance().openUI(c.UIID.UITips, -1, "该装备已达到最大星级") : n.EventMgr.getInstance().emit(c.EventName.PlaceCompositeEquip, t.curBagIndex, t.equipData));
    });
  }, e.prototype.initData = function (t, e, o) {
    this.curBagIndex = t, this.equipData = e, this.uiView = o, this.registerBtnEvent(), this.equipHCForRedDot();
  }, e.prototype.refresData = function (t, e) {
    this.curBagIndex = t, this.equipData = e;
  }, e.prototype.equipHCForRedDot = function () {
    var t = u.PlayerMgr.getInstance().getAbType();

    if ("D" == t || "B" == t) {
      for (var e = !1, o = l["default"].getInstance().getOwmedEquipForEquipType(this.equipData.type), a = 0; a < o.length; a++) {
        if (o[a].IDCard != this.equipData.IDCard && o[a].id == this.equipData.id && o[a].type == this.equipData.type && o[a].starLevel == this.equipData.starLevel) {
          e = !0;
          break;
        }
      }

      this.node.getChildByName("SpRedDot").active = e;
    }
  }, r([g], e);
}(cc.Component));
o["default"] = d;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcTm9kZUVxdWlwQ29tcG9zaXRlLmpzIl0sIm5hbWVzIjpbInQiLCJyZXF1aXJlIiwiZSIsIm1vZHVsZSIsIm8iLCJleHBvcnRzIiwiYSIsImkiLCJfX2V4dGVuZHMiLCJPYmplY3QiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIkFycmF5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiY29uc3RydWN0b3IiLCJjcmVhdGUiLCJyIiwiX19kZWNvcmF0ZSIsImFyZ3VtZW50cyIsImxlbmd0aCIsIm4iLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJSZWZsZWN0IiwiZGVjb3JhdGUiLCJzIiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsImMiLCJsIiwidSIsInAiLCJjYyIsIl9kZWNvcmF0b3IiLCJnIiwiY2NjbGFzcyIsImQiLCJwcm9wZXJ0eSIsImFwcGx5IiwidWlWaWV3IiwiVUlJRCIsIlVJRXF1aXAiLCJjdXJCYWdJbmRleCIsImVxdWlwRGF0YSIsInN0YXJ0IiwicmVnaXN0ZXJCdG5FdmVudCIsIm5vZGUiLCJvbiIsIk5vZGUiLCJFdmVudFR5cGUiLCJUT1VDSF9FTkQiLCJnZXRDaGlsZEJ5TmFtZSIsImFjdGl2ZSIsInN0YXJMZXZlbCIsIlVJTWdyIiwiZ2V0SW5zdGFuY2UiLCJvcGVuVUkiLCJVSVRpcHMiLCJFdmVudE1nciIsImVtaXQiLCJFdmVudE5hbWUiLCJQbGFjZUNvbXBvc2l0ZUVxdWlwIiwiaW5pdERhdGEiLCJlcXVpcEhDRm9yUmVkRG90IiwicmVmcmVzRGF0YSIsIlBsYXllck1nciIsImdldEFiVHlwZSIsImdldE93bWVkRXF1aXBGb3JFcXVpcFR5cGUiLCJ0eXBlIiwiSURDYXJkIiwiaWQiLCJDb21wb25lbnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBQyxHQUFHQyxPQUFSO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHQyxNQUFSO0FBQ0Es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LEVBQVI7O0lBQ0EsSUFBSSxPQUFPbkUsQ0FBUCxJQUFZLE9BQU9BLENBQXZCLEVBQTBCO01BQ3RCLEtBQUssSUFBSUUsQ0FBQyxHQUFHLENBQUMsQ0FBVCxFQUNMRSxDQUFDLEdBQUcwQixDQUFDLFdBQUQsQ0FBVTBCLFdBQVYsR0FBd0JZLHlCQUF4QixDQUFrRCxLQUFLeEIsU0FBTCxDQUFleUIsSUFBakUsQ0FEQyxFQUN1RS9ELENBQUMsR0FBRyxDQURoRixFQUNtRkEsQ0FBQyxHQUFHRixDQUFDLENBQUNpQixNQUR6RixFQUNpR2YsQ0FBQyxFQURsRztRQUNzRyxJQUFJRixDQUFDLENBQUNFLENBQUQsQ0FBRCxDQUFLZ0UsTUFBTCxJQUFlLEtBQUsxQixTQUFMLENBQWUwQixNQUE5QixJQUF3Q2xFLENBQUMsQ0FBQ0UsQ0FBRCxDQUFELENBQUtpRSxFQUFMLElBQVcsS0FBSzNCLFNBQUwsQ0FBZTJCLEVBQWxFLElBQXdFbkUsQ0FBQyxDQUFDRSxDQUFELENBQUQsQ0FBSytELElBQUwsSUFBYSxLQUFLekIsU0FBTCxDQUFleUIsSUFBcEcsSUFBNEdqRSxDQUFDLENBQUNFLENBQUQsQ0FBRCxDQUFLZ0QsU0FBTCxJQUFrQixLQUFLVixTQUFMLENBQWVVLFNBQWpKLEVBQTRKO1VBQzlQcEQsQ0FBQyxHQUFHLENBQUMsQ0FBTDtVQUNBO1FBQ0g7TUFKRDs7TUFLQSxLQUFLNkMsSUFBTCxDQUFVSyxjQUFWLENBQXlCLFVBQXpCLEVBQXFDQyxNQUFyQyxHQUE4Q25ELENBQTlDO0lBQ0g7RUFDSixDQTlCTSxFQStCUGdCLENBQUMsQ0FBQyxDQUFDaUIsQ0FBRCxDQUFELEVBQU1qQyxDQUFOLENBL0JEO0FBZ0NILENBeENELENBd0NHK0IsRUFBRSxDQUFDdUMsU0F4Q04sQ0FEQyxDQVBEO0FBaURBcEUsQ0FBQyxXQUFELEdBQVlpQyxDQUFaIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdCA9IHJlcXVpcmU7XG52YXIgZSA9IG1vZHVsZTtcbnZhciBvID0gZXhwb3J0cztcbnZhciBhLCBpID0gdGhpcyAmJiB0aGlzLl9fZXh0ZW5kcyB8fCAoYSA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICByZXR1cm4gKGEgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwge1xuICAgICAgICBfX3Byb3RvX186IFtdXG4gICAgfVxuICAgIGluc3RhbmNlb2YgQXJyYXkgJiZcbiAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHQuX19wcm90b19fID0gZVxuICAgIH0gfHxcbiAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGZvciAodmFyIG8gaW4gZSkgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsIG8pICYmICh0W29dID0gZVtvXSlcbiAgICB9KSh0LCBlKVxufSxcbmZ1bmN0aW9uKHQsIGUpIHtcbiAgICBmdW5jdGlvbiBvKCkge1xuICAgICAgICB0aGlzLmNvbnN0cnVjdG9yID0gdFxuICAgIH1cbiAgICBhKHQsIGUpLFxuICAgIHQucHJvdG90eXBlID0gbnVsbCA9PT0gZSA/IE9iamVjdC5jcmVhdGUoZSkgOiAoby5wcm90b3R5cGUgPSBlLnByb3RvdHlwZSwgbmV3IG8pXG59KSxcbnIgPSB0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSB8fFxuZnVuY3Rpb24odCwgZSwgbywgYSkge1xuICAgIHZhciBpLCByID0gYXJndW1lbnRzLmxlbmd0aCxcbiAgICBuID0gciA8IDMgPyBlOiBudWxsID09PSBhID8gYSA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgbykgOiBhO1xuICAgIGlmIChcIm9iamVjdFwiID09IHR5cGVvZiBSZWZsZWN0ICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSkgbiA9IFJlZmxlY3QuZGVjb3JhdGUodCwgZSwgbywgYSk7XG4gICAgZWxzZSBmb3IgKHZhciBzID0gdC5sZW5ndGggLSAxOyBzID49IDA7IHMtLSkoaSA9IHRbc10pICYmIChuID0gKHIgPCAzID8gaShuKSA6IHIgPiAzID8gaShlLCBvLCBuKSA6IGkoZSwgbykpIHx8IG4pO1xuICAgIHJldHVybiByID4gMyAmJiBuICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCBvLCBuKSxcbiAgICBuXG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6ICEwXG59KTtcbnZhciBuID0gdChcIkV2ZW50TWdyXCIpLFxucyA9IHQoXCJVSU1nclwiKSxcbmMgPSB0KFwiQ29uZmlnXCIpLFxubCA9IHQoXCJFcXVpcE1nclwiKSxcbnUgPSB0KFwiUGxheWVyTWdyXCIpLFxucCA9IGNjLl9kZWNvcmF0b3IsXG5nID0gcC5jY2NsYXNzLFxuZCA9IChwLnByb3BlcnR5LFxuZnVuY3Rpb24odCkge1xuICAgIGZ1bmN0aW9uIGUoKSB7XG4gICAgICAgIHZhciBlID0gbnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgcmV0dXJuIGUudWlWaWV3ID0gYy5VSUlELlVJRXF1aXAsXG4gICAgICAgIGUuY3VyQmFnSW5kZXggPSAxLFxuICAgICAgICBlLmVxdWlwRGF0YSA9IG51bGwsXG4gICAgICAgIGVcbiAgICB9XG4gICAgcmV0dXJuIGkoZSwgdCksXG4gICAgZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigpIHt9LFxuICAgIGUucHJvdG90eXBlLnJlZ2lzdGVyQnRuRXZlbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELFxuICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHQubm9kZS5nZXRDaGlsZEJ5TmFtZShcIlNwTWFza1wiKS5hY3RpdmUgfHwgKHQuZXF1aXBEYXRhLnN0YXJMZXZlbCA+PSA1ID8gcy5VSU1nci5nZXRJbnN0YW5jZSgpLm9wZW5VSShjLlVJSUQuVUlUaXBzLCAtMSwgXCLor6Xoo4XlpIflt7Lovr7liLDmnIDlpKfmmJ/nuqdcIikgOiBuLkV2ZW50TWdyLmdldEluc3RhbmNlKCkuZW1pdChjLkV2ZW50TmFtZS5QbGFjZUNvbXBvc2l0ZUVxdWlwLCB0LmN1ckJhZ0luZGV4LCB0LmVxdWlwRGF0YSkpXG4gICAgICAgIH0pXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5pbml0RGF0YSA9IGZ1bmN0aW9uKHQsIGUsIG8pIHtcbiAgICAgICAgdGhpcy5jdXJCYWdJbmRleCA9IHQsXG4gICAgICAgIHRoaXMuZXF1aXBEYXRhID0gZSxcbiAgICAgICAgdGhpcy51aVZpZXcgPSBvLFxuICAgICAgICB0aGlzLnJlZ2lzdGVyQnRuRXZlbnQoKSxcbiAgICAgICAgdGhpcy5lcXVpcEhDRm9yUmVkRG90KClcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLnJlZnJlc0RhdGEgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHRoaXMuY3VyQmFnSW5kZXggPSB0LFxuICAgICAgICB0aGlzLmVxdWlwRGF0YSA9IGVcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLmVxdWlwSENGb3JSZWREb3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHQgPSB1LlBsYXllck1nci5nZXRJbnN0YW5jZSgpLmdldEFiVHlwZSgpO1xuICAgICAgICBpZiAoXCJEXCIgPT0gdCB8fCBcIkJcIiA9PSB0KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBlID0gITEsXG4gICAgICAgICAgICBvID0gbC5kZWZhdWx0LmdldEluc3RhbmNlKCkuZ2V0T3dtZWRFcXVpcEZvckVxdWlwVHlwZSh0aGlzLmVxdWlwRGF0YS50eXBlKSwgYSA9IDA7IGEgPCBvLmxlbmd0aDsgYSsrKSBpZiAob1thXS5JRENhcmQgIT0gdGhpcy5lcXVpcERhdGEuSURDYXJkICYmIG9bYV0uaWQgPT0gdGhpcy5lcXVpcERhdGEuaWQgJiYgb1thXS50eXBlID09IHRoaXMuZXF1aXBEYXRhLnR5cGUgJiYgb1thXS5zdGFyTGV2ZWwgPT0gdGhpcy5lcXVpcERhdGEuc3RhckxldmVsKSB7XG4gICAgICAgICAgICAgICAgZSA9ICEwO1xuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJTcFJlZERvdFwiKS5hY3RpdmUgPSBlXG4gICAgICAgIH1cbiAgICB9LFxuICAgIHIoW2ddLCBlKVxufSAoY2MuQ29tcG9uZW50KSk7XG5vLmRlZmF1bHQgPSBkIl19