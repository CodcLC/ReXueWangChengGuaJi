
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/CameraMgr.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'bdbc4VXBTFMq7Kf0c9zdi09', 'CameraMgr');
// scripts/CameraMgr.js

"use strict";

var t = require;
var e = module;
var o = exports;

var _a,
    i = void 0 && (void 0).__extends || (_a = function a(t, e) {
  return (_a = Object.setPrototypeOf || {
    __proto__: []
  } instanceof Array && function (t, e) {
    t.__proto__ = e;
  } || function (t, e) {
    for (var o in e) {
      Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]);
    }
  })(t, e);
}, function (t, e) {
  function o() {
    this.constructor = t;
  }

  _a(t, e), t.prototype = null === e ? Object.create(e) : (o.prototype = e.prototype, new o());
}),
    r = void 0 && (void 0).__decorate || function (t, e, o, a) {
  var i,
      r = arguments.length,
      n = r < 3 ? e : null === a ? a = Object.getOwnPropertyDescriptor(e, o) : a;
  if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) n = Reflect.decorate(t, e, o, a);else for (var s = t.length - 1; s >= 0; s--) {
    (i = t[s]) && (n = (r < 3 ? i(n) : r > 3 ? i(e, o, n) : i(e, o)) || n);
  }
  return r > 3 && n && Object.defineProperty(e, o, n), n;
};

Object.defineProperty(o, "__esModule", {
  value: !0
});

var n = t("Main"),
    s = t("Config"),
    c = t("GameDataMgr"),
    l = cc._decorator,
    u = l.ccclass,
    p = l.property,
    g = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    return e.posIndex = cc.Vec2.ZERO, e.gameCamera = null, e.isShake = !1, e.tween_shake = null, e;
  }

  return i(e, t), e.prototype.start = function () {}, e.prototype.lateUpdate = function () {
    if (!c["default"].getInstance().isCurGameState(s.EnumGameState.GameOver) && !this.isShake && n["default"].instance.player && n["default"].instance.player.object) {
      var t = n["default"].instance.player.object.x - this.node.x,
          e = 4 * cc.director.getDeltaTime();
      this.node.x += t * e;
    }
  }, e.prototype.resetPos = function () {
    this.gameCamera.zoomRatio = 1, this.node.setPosition(cc.Vec2.ZERO);
  }, e.prototype.shakeAnim = function () {
    var t = this;
    this.tween_shake && (this.tween_shake.stop(), this.tween_shake = null, this.node.y = 0, this.isShake = !1), this.isShake = !0, this.tween_shake = cc.tween(this.node).parallel(cc.tween().by(.02, {
      x: -10
    }), cc.tween().by(.02, {
      y: -10
    })).by(.02, {
      x: 10
    }).parallel(cc.tween().by(.02, {
      x: -15
    }), cc.tween().by(.02, {
      y: 15
    })).parallel(cc.tween().by(.02, {
      x: 5
    }), cc.tween().by(.02, {
      y: 5
    })).parallel(cc.tween().by(.02, {
      x: 5
    }), cc.tween().by(.02, {
      y: -20
    })).parallel(cc.tween().by(.02, {
      x: 5
    }), cc.tween().by(.02, {
      y: 10
    })).call(function () {
      t.isShake = !1;
    }).start();
  }, e.prototype.controlCameraZoom = function (t, e, o) {
    cc.tween(this.gameCamera).to(t, {
      zoomRatio: e
    }).call(function () {
      o && o();
    }).start();
  }, r([p(cc.Camera)], e.prototype, "gameCamera", void 0), r([u], e);
}(cc.Component);

o["default"] = g;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcQ2FtZXJhTWdyLmpzIl0sIm5hbWVzIjpbInQiLCJyZXF1aXJlIiwiZSIsIm1vZHVsZSIsIm8iLCJleHBvcnRzIiwiYSIsImkiLCJfX2V4dGVuZHMiLCJPYmplY3QiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIkFycmF5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiY29uc3RydWN0b3IiLCJjcmVhdGUiLCJyIiwiX19kZWNvcmF0ZSIsImFyZ3VtZW50cyIsImxlbmd0aCIsIm4iLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJSZWZsZWN0IiwiZGVjb3JhdGUiLCJzIiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsImMiLCJsIiwiY2MiLCJfZGVjb3JhdG9yIiwidSIsImNjY2xhc3MiLCJwIiwicHJvcGVydHkiLCJnIiwiYXBwbHkiLCJwb3NJbmRleCIsIlZlYzIiLCJaRVJPIiwiZ2FtZUNhbWVyYSIsImlzU2hha2UiLCJ0d2Vlbl9zaGFrZSIsInN0YXJ0IiwibGF0ZVVwZGF0ZSIsImdldEluc3RhbmNlIiwiaXNDdXJHYW1lU3RhdGUiLCJFbnVtR2FtZVN0YXRlIiwiR2FtZU92ZXIiLCJpbnN0YW5jZSIsInBsYXllciIsIm9iamVjdCIsIngiLCJub2RlIiwiZGlyZWN0b3IiLCJnZXREZWx0YVRpbWUiLCJyZXNldFBvcyIsInpvb21SYXRpbyIsInNldFBvc2l0aW9uIiwic2hha2VBbmltIiwic3RvcCIsInkiLCJ0d2VlbiIsInBhcmFsbGVsIiwiYnkiLCJjb250cm9sQ2FtZXJhWm9vbSIsInRvIiwiQ2FtZXJhIiwiQ29tcG9uZW50Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUMsR0FBR0MsT0FBUjtBQUNBLElBQUlDLENBQUMsR0FBR0MsTUFBUjtBQUNBLElBQUlDLENBQUMsR0FBR0MsT0FBUjs7QUFDQSxJQUFJQyxFQUFKO0FBQUEsSUFBT0MsQ0FBQyxH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QUFGLEdBQVksQ0FBQyxDQUFiO0lBQ0gsQ0F4QmtCLEVBd0JoQkUsS0F4QmdCLEVBRm5CO0VBMkJILENBMUNNLEVBMkNQM0MsQ0FBQyxDQUFDVyxTQUFGLENBQVlzRCxpQkFBWixHQUFnQyxVQUFTbkUsQ0FBVCxFQUFZRSxDQUFaLEVBQWVFLENBQWYsRUFBa0I7SUFDOUMyQixFQUFFLENBQUNpQyxLQUFILENBQVMsS0FBS3RCLFVBQWQsRUFBMEIwQixFQUExQixDQUE2QnBFLENBQTdCLEVBQWdDO01BQzVCMkQsU0FBUyxFQUFFekQ7SUFEaUIsQ0FBaEMsRUFFR2EsSUFGSCxDQUVRLFlBQVc7TUFDZlgsQ0FBQyxJQUFJQSxDQUFDLEVBQU47SUFDSCxDQUpELEVBSUd5QyxLQUpIO0VBS0gsQ0FqRE0sRUFrRFAzQixDQUFDLENBQUMsQ0FBQ2lCLENBQUMsQ0FBQ0osRUFBRSxDQUFDc0MsTUFBSixDQUFGLENBQUQsRUFBaUJuRSxDQUFDLENBQUNXLFNBQW5CLEVBQThCLFlBQTlCLEVBQTRDLEtBQUssQ0FBakQsQ0FsRE0sRUFtRFBLLENBQUMsQ0FBQyxDQUFDZSxDQUFELENBQUQsRUFBTS9CLENBQU4sQ0FuREQ7QUFvREgsQ0E3REcsQ0E2REQ2QixFQUFFLENBQUN1QyxTQTdERixDQU5KOztBQW9FQWxFLENBQUMsV0FBRCxHQUFZaUMsQ0FBWiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHQgPSByZXF1aXJlO1xudmFyIGUgPSBtb2R1bGU7XG52YXIgbyA9IGV4cG9ydHM7XG52YXIgYSwgaSA9IHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMgfHwgKGEgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgcmV0dXJuIChhID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IHtcbiAgICAgICAgX19wcm90b19fOiBbXVxuICAgIH1cbiAgICBpbnN0YW5jZW9mIEFycmF5ICYmXG4gICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICB0Ll9fcHJvdG9fXyA9IGVcbiAgICB9IHx8XG4gICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBmb3IgKHZhciBvIGluIGUpIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLCBvKSAmJiAodFtvXSA9IGVbb10pXG4gICAgfSkodCwgZSlcbn0sXG5mdW5jdGlvbih0LCBlKSB7XG4gICAgZnVuY3Rpb24gbygpIHtcbiAgICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IHRcbiAgICB9XG4gICAgYSh0LCBlKSxcbiAgICB0LnByb3RvdHlwZSA9IG51bGwgPT09IGUgPyBPYmplY3QuY3JlYXRlKGUpIDogKG8ucHJvdG90eXBlID0gZS5wcm90b3R5cGUsIG5ldyBvKVxufSksXG5yID0gdGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUgfHxcbmZ1bmN0aW9uKHQsIGUsIG8sIGEpIHtcbiAgICB2YXIgaSwgciA9IGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgbiA9IHIgPCAzID8gZTogbnVsbCA9PT0gYSA/IGEgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIG8pIDogYTtcbiAgICBpZiAoXCJvYmplY3RcIiA9PSB0eXBlb2YgUmVmbGVjdCAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUpIG4gPSBSZWZsZWN0LmRlY29yYXRlKHQsIGUsIG8sIGEpO1xuICAgIGVsc2UgZm9yICh2YXIgcyA9IHQubGVuZ3RoIC0gMTsgcyA+PSAwOyBzLS0pKGkgPSB0W3NdKSAmJiAobiA9IChyIDwgMyA/IGkobikgOiByID4gMyA/IGkoZSwgbywgbikgOiBpKGUsIG8pKSB8fCBuKTtcbiAgICByZXR1cm4gciA+IDMgJiYgbiAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgbywgbiksXG4gICAgblxufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiAhMFxufSk7XG52YXIgbiA9IHQoXCJNYWluXCIpLFxucyA9IHQoXCJDb25maWdcIiksXG5jID0gdChcIkdhbWVEYXRhTWdyXCIpLFxubCA9IGNjLl9kZWNvcmF0b3IsXG51ID0gbC5jY2NsYXNzLFxucCA9IGwucHJvcGVydHksXG5nID0gZnVuY3Rpb24odCkge1xuICAgIGZ1bmN0aW9uIGUoKSB7XG4gICAgICAgIHZhciBlID0gbnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgcmV0dXJuIGUucG9zSW5kZXggPSBjYy5WZWMyLlpFUk8sXG4gICAgICAgIGUuZ2FtZUNhbWVyYSA9IG51bGwsXG4gICAgICAgIGUuaXNTaGFrZSA9ICExLFxuICAgICAgICBlLnR3ZWVuX3NoYWtlID0gbnVsbCxcbiAgICAgICAgZVxuICAgIH1cbiAgICByZXR1cm4gaShlLCB0KSxcbiAgICBlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKCkge30sXG4gICAgZS5wcm90b3R5cGUubGF0ZVVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIWMuZGVmYXVsdC5nZXRJbnN0YW5jZSgpLmlzQ3VyR2FtZVN0YXRlKHMuRW51bUdhbWVTdGF0ZS5HYW1lT3ZlcikgJiYgIXRoaXMuaXNTaGFrZSAmJiBuLmRlZmF1bHQuaW5zdGFuY2UucGxheWVyICYmIG4uZGVmYXVsdC5pbnN0YW5jZS5wbGF5ZXIub2JqZWN0KSB7XG4gICAgICAgICAgICB2YXIgdCA9IG4uZGVmYXVsdC5pbnN0YW5jZS5wbGF5ZXIub2JqZWN0LnggLSB0aGlzLm5vZGUueCxcbiAgICAgICAgICAgIGUgPSA0ICogY2MuZGlyZWN0b3IuZ2V0RGVsdGFUaW1lKCk7XG4gICAgICAgICAgICB0aGlzLm5vZGUueCArPSB0ICogZVxuICAgICAgICB9XG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5yZXNldFBvcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmdhbWVDYW1lcmEuem9vbVJhdGlvID0gMSxcbiAgICAgICAgdGhpcy5ub2RlLnNldFBvc2l0aW9uKGNjLlZlYzIuWkVSTylcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLnNoYWtlQW5pbSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdCA9IHRoaXM7XG4gICAgICAgIHRoaXMudHdlZW5fc2hha2UgJiYgKHRoaXMudHdlZW5fc2hha2Uuc3RvcCgpLCB0aGlzLnR3ZWVuX3NoYWtlID0gbnVsbCwgdGhpcy5ub2RlLnkgPSAwLCB0aGlzLmlzU2hha2UgPSAhMSksXG4gICAgICAgIHRoaXMuaXNTaGFrZSA9ICEwLFxuICAgICAgICB0aGlzLnR3ZWVuX3NoYWtlID0gY2MudHdlZW4odGhpcy5ub2RlKS5wYXJhbGxlbChjYy50d2VlbigpLmJ5KC4wMiwge1xuICAgICAgICAgICAgeDogLTEwXG4gICAgICAgIH0pLCBjYy50d2VlbigpLmJ5KC4wMiwge1xuICAgICAgICAgICAgeTogLTEwXG4gICAgICAgIH0pKS5ieSguMDIsIHtcbiAgICAgICAgICAgIHg6IDEwXG4gICAgICAgIH0pLnBhcmFsbGVsKGNjLnR3ZWVuKCkuYnkoLjAyLCB7XG4gICAgICAgICAgICB4OiAtMTVcbiAgICAgICAgfSksIGNjLnR3ZWVuKCkuYnkoLjAyLCB7XG4gICAgICAgICAgICB5OiAxNVxuICAgICAgICB9KSkucGFyYWxsZWwoY2MudHdlZW4oKS5ieSguMDIsIHtcbiAgICAgICAgICAgIHg6IDVcbiAgICAgICAgfSksIGNjLnR3ZWVuKCkuYnkoLjAyLCB7XG4gICAgICAgICAgICB5OiA1XG4gICAgICAgIH0pKS5wYXJhbGxlbChjYy50d2VlbigpLmJ5KC4wMiwge1xuICAgICAgICAgICAgeDogNVxuICAgICAgICB9KSwgY2MudHdlZW4oKS5ieSguMDIsIHtcbiAgICAgICAgICAgIHk6IC0yMFxuICAgICAgICB9KSkucGFyYWxsZWwoY2MudHdlZW4oKS5ieSguMDIsIHtcbiAgICAgICAgICAgIHg6IDVcbiAgICAgICAgfSksIGNjLnR3ZWVuKCkuYnkoLjAyLCB7XG4gICAgICAgICAgICB5OiAxMFxuICAgICAgICB9KSkuY2FsbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHQuaXNTaGFrZSA9ICExXG4gICAgICAgIH0pLnN0YXJ0KClcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLmNvbnRyb2xDYW1lcmFab29tID0gZnVuY3Rpb24odCwgZSwgbykge1xuICAgICAgICBjYy50d2Vlbih0aGlzLmdhbWVDYW1lcmEpLnRvKHQsIHtcbiAgICAgICAgICAgIHpvb21SYXRpbzogZVxuICAgICAgICB9KS5jYWxsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbyAmJiBvKClcbiAgICAgICAgfSkuc3RhcnQoKVxuICAgIH0sXG4gICAgcihbcChjYy5DYW1lcmEpXSwgZS5wcm90b3R5cGUsIFwiZ2FtZUNhbWVyYVwiLCB2b2lkIDApLFxuICAgIHIoW3VdLCBlKVxufSAoY2MuQ29tcG9uZW50KTtcbm8uZGVmYXVsdCA9IGciXX0=