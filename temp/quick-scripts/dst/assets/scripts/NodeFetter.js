
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/NodeFetter.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'c152e/MMplO8q7fePzmlCzq', 'NodeFetter');
// scripts/NodeFetter.js

"use strict";

var t = require;
var e = module;
var o = exports;

var _a,
    i = void 0 && (void 0).__extends || (_a = function a(t, e) {
  return (_a = Object.setPrototypeOf || {
    __proto__: []
  } instanceof Array && function (t, e) {
    t.__proto__ = e;
  } || function (t, e) {
    for (var o in e) {
      Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]);
    }
  })(t, e);
}, function (t, e) {
  function o() {
    this.constructor = t;
  }

  _a(t, e), t.prototype = null === e ? Object.create(e) : (o.prototype = e.prototype, new o());
}),
    r = void 0 && (void 0).__decorate || function (t, e, o, a) {
  var i,
      r = arguments.length,
      n = r < 3 ? e : null === a ? a = Object.getOwnPropertyDescriptor(e, o) : a;
  if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) n = Reflect.decorate(t, e, o, a);else for (var s = t.length - 1; s >= 0; s--) {
    (i = t[s]) && (n = (r < 3 ? i(n) : r > 3 ? i(e, o, n) : i(e, o)) || n);
  }
  return r > 3 && n && Object.defineProperty(e, o, n), n;
};

Object.defineProperty(o, "__esModule", {
  value: !0
});

var n = t("EventMgr"),
    s = t("UIMgr"),
    c = t("Utils"),
    l = t("Config"),
    u = t("GameDataMgr"),
    p = cc._decorator,
    g = p.ccclass,
    d = p.property,
    h = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    return e.SpSelect = null, e.LabFetterNum = null, e.fetterId = 1, e.fetterData = null, e;
  }

  return i(e, t), e.prototype.onLoad = function () {}, e.prototype.start = function () {}, e.prototype.registerEvent = function () {
    n.EventMgr.getInstance().on(l.EventName.RefreshFetterShow, this, this.refreshFetterShow), n.EventMgr.getInstance().on(l.EventName.RefreshLight, this, this.refreshLight);
  }, e.prototype.registerBtnEvent = function () {
    var t = this;
    this.node.on(cc.Node.EventType.TOUCH_END, function () {
      var e = c.Utils.posTransform(t.node.parent, t.node.getPosition(), s.UIMgr.getInstance().getUIRoot(l.UIID.UIGame));
      s.UIMgr.getInstance().openUI(l.UIID.UIFetterInfo, -1, t.fetterId, e);
    });
  }, e.prototype.initData = function (t) {
    this.fetterId = t, this.registerEvent(), this.registerBtnEvent();
  }, e.prototype.refreshFetterShow = function (t) {
    this.fetterId === t && (this.LabFetterNum.string = u["default"].getInstance().getStringForFetterId(this.fetterId));
  }, e.prototype.refreshLight = function (t) {
    this.fetterId === t && this.lightAnim();
  }, e.prototype.lightAnim = function () {
    cc.isValid(this.SpSelect) && (this.SpSelect.opacity = 0, cc.tween(this.SpSelect).to(.3, {
      opacity: 255
    }).to(.8, {
      opacity: 100
    }).to(.6, {
      opacity: 255
    }).to(.5, {
      opacity: 0
    }).start());
  }, e.prototype.onDestroy = function () {
    n.EventMgr.getInstance().off(l.EventName.RefreshFetterShow, this, this.refreshFetterShow), n.EventMgr.getInstance().off(l.EventName.RefreshLight, this, this.refreshLight);
  }, r([d(cc.Node)], e.prototype, "SpSelect", void 0), r([d(cc.RichText)], e.prototype, "LabFetterNum", void 0), r([g], e);
}(cc.Component);

o["default"] = h;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcTm9kZUZldHRlci5qcyJdLCJuYW1lcyI6WyJ0IiwicmVxdWlyZSIsImUiLCJtb2R1bGUiLCJvIiwiZXhwb3J0cyIsImEiLCJpIiwiX19leHRlbmRzIiwiT2JqZWN0Iiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiciIsIl9fZGVjb3JhdGUiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJuIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiUmVmbGVjdCIsImRlY29yYXRlIiwicyIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJjIiwibCIsInUiLCJwIiwiY2MiLCJfZGVjb3JhdG9yIiwiZyIsImNjY2xhc3MiLCJkIiwicHJvcGVydHkiLCJoIiwiYXBwbHkiLCJTcFNlbGVjdCIsIkxhYkZldHRlck51bSIsImZldHRlcklkIiwiZmV0dGVyRGF0YSIsIm9uTG9hZCIsInN0YXJ0IiwicmVnaXN0ZXJFdmVudCIsIkV2ZW50TWdyIiwiZ2V0SW5zdGFuY2UiLCJvbiIsIkV2ZW50TmFtZSIsIlJlZnJlc2hGZXR0ZXJTaG93IiwicmVmcmVzaEZldHRlclNob3ciLCJSZWZyZXNoTGlnaHQiLCJyZWZyZXNoTGlnaHQiLCJyZWdpc3RlckJ0bkV2ZW50Iiwibm9kZSIsIk5vZGUiLCJFdmVudFR5cGUiLCJUT1VDSF9FTkQiLCJVdGlscyIsInBvc1RyYW5zZm9ybSIsInBhcmVudCIsImdldFBvc2l0aW9uIiwiVUlNZ3IiLCJnZXRVSVJvb3QiLCJVSUlEIiwiVUlHYW1lIiwib3BlblVJIiwiVUlGZXR0ZXJJbmZvIiwiaW5pdERhdGEiLCJzdHJpbmciLCJnZXRTdHJpbmdGb3JGZXR0ZXJJZCIsImxpZ2h0QW5pbSIsImlzVmFsaWQiLCJvcGFjaXR5IiwidHdlZW4iLCJ0byIsIm9uRGVzdHJveSIsIm9mZiIsIlJpY2hUZXh0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RUFTSCxDQXBDTSxFQXFDUDVDLENBQUMsQ0FBQ1csU0FBRixDQUFZa0UsU0FBWixHQUF3QixZQUFXO0lBQy9CekQsQ0FBQyxDQUFDMEIsUUFBRixDQUFXQyxXQUFYLEdBQXlCK0IsR0FBekIsQ0FBNkJsRCxDQUFDLENBQUNxQixTQUFGLENBQVlDLGlCQUF6QyxFQUE0RCxJQUE1RCxFQUFrRSxLQUFLQyxpQkFBdkUsR0FDQS9CLENBQUMsQ0FBQzBCLFFBQUYsQ0FBV0MsV0FBWCxHQUF5QitCLEdBQXpCLENBQTZCbEQsQ0FBQyxDQUFDcUIsU0FBRixDQUFZRyxZQUF6QyxFQUF1RCxJQUF2RCxFQUE2RCxLQUFLQyxZQUFsRSxDQURBO0VBRUgsQ0F4Q00sRUF5Q1ByQyxDQUFDLENBQUMsQ0FBQ21CLENBQUMsQ0FBQ0osRUFBRSxDQUFDeUIsSUFBSixDQUFGLENBQUQsRUFBZXhELENBQUMsQ0FBQ1csU0FBakIsRUFBNEIsVUFBNUIsRUFBd0MsS0FBSyxDQUE3QyxDQXpDTSxFQTBDUEssQ0FBQyxDQUFDLENBQUNtQixDQUFDLENBQUNKLEVBQUUsQ0FBQ2dELFFBQUosQ0FBRixDQUFELEVBQW1CL0UsQ0FBQyxDQUFDVyxTQUFyQixFQUFnQyxjQUFoQyxFQUFnRCxLQUFLLENBQXJELENBMUNNLEVBMkNQSyxDQUFDLENBQUMsQ0FBQ2lCLENBQUQsQ0FBRCxFQUFNakMsQ0FBTixDQTNDRDtBQTRDSCxDQXJERyxDQXFERCtCLEVBQUUsQ0FBQ2lELFNBckRGLENBUko7O0FBOERBOUUsQ0FBQyxXQUFELEdBQVltQyxDQUFaIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdCA9IHJlcXVpcmU7XG52YXIgZSA9IG1vZHVsZTtcbnZhciBvID0gZXhwb3J0cztcbnZhciBhLCBpID0gdGhpcyAmJiB0aGlzLl9fZXh0ZW5kcyB8fCAoYSA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICByZXR1cm4gKGEgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwge1xuICAgICAgICBfX3Byb3RvX186IFtdXG4gICAgfVxuICAgIGluc3RhbmNlb2YgQXJyYXkgJiZcbiAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHQuX19wcm90b19fID0gZVxuICAgIH0gfHxcbiAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGZvciAodmFyIG8gaW4gZSkgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsIG8pICYmICh0W29dID0gZVtvXSlcbiAgICB9KSh0LCBlKVxufSxcbmZ1bmN0aW9uKHQsIGUpIHtcbiAgICBmdW5jdGlvbiBvKCkge1xuICAgICAgICB0aGlzLmNvbnN0cnVjdG9yID0gdFxuICAgIH1cbiAgICBhKHQsIGUpLFxuICAgIHQucHJvdG90eXBlID0gbnVsbCA9PT0gZSA/IE9iamVjdC5jcmVhdGUoZSkgOiAoby5wcm90b3R5cGUgPSBlLnByb3RvdHlwZSwgbmV3IG8pXG59KSxcbnIgPSB0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSB8fFxuZnVuY3Rpb24odCwgZSwgbywgYSkge1xuICAgIHZhciBpLCByID0gYXJndW1lbnRzLmxlbmd0aCxcbiAgICBuID0gciA8IDMgPyBlOiBudWxsID09PSBhID8gYSA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgbykgOiBhO1xuICAgIGlmIChcIm9iamVjdFwiID09IHR5cGVvZiBSZWZsZWN0ICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSkgbiA9IFJlZmxlY3QuZGVjb3JhdGUodCwgZSwgbywgYSk7XG4gICAgZWxzZSBmb3IgKHZhciBzID0gdC5sZW5ndGggLSAxOyBzID49IDA7IHMtLSkoaSA9IHRbc10pICYmIChuID0gKHIgPCAzID8gaShuKSA6IHIgPiAzID8gaShlLCBvLCBuKSA6IGkoZSwgbykpIHx8IG4pO1xuICAgIHJldHVybiByID4gMyAmJiBuICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCBvLCBuKSxcbiAgICBuXG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6ICEwXG59KTtcbnZhciBuID0gdChcIkV2ZW50TWdyXCIpLFxucyA9IHQoXCJVSU1nclwiKSxcbmMgPSB0KFwiVXRpbHNcIiksXG5sID0gdChcIkNvbmZpZ1wiKSxcbnUgPSB0KFwiR2FtZURhdGFNZ3JcIiksXG5wID0gY2MuX2RlY29yYXRvcixcbmcgPSBwLmNjY2xhc3MsXG5kID0gcC5wcm9wZXJ0eSxcbmggPSBmdW5jdGlvbih0KSB7XG4gICAgZnVuY3Rpb24gZSgpIHtcbiAgICAgICAgdmFyIGUgPSBudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICByZXR1cm4gZS5TcFNlbGVjdCA9IG51bGwsXG4gICAgICAgIGUuTGFiRmV0dGVyTnVtID0gbnVsbCxcbiAgICAgICAgZS5mZXR0ZXJJZCA9IDEsXG4gICAgICAgIGUuZmV0dGVyRGF0YSA9IG51bGwsXG4gICAgICAgIGVcbiAgICB9XG4gICAgcmV0dXJuIGkoZSwgdCksXG4gICAgZS5wcm90b3R5cGUub25Mb2FkID0gZnVuY3Rpb24oKSB7fSxcbiAgICBlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKCkge30sXG4gICAgZS5wcm90b3R5cGUucmVnaXN0ZXJFdmVudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBuLkV2ZW50TWdyLmdldEluc3RhbmNlKCkub24obC5FdmVudE5hbWUuUmVmcmVzaEZldHRlclNob3csIHRoaXMsIHRoaXMucmVmcmVzaEZldHRlclNob3cpLFxuICAgICAgICBuLkV2ZW50TWdyLmdldEluc3RhbmNlKCkub24obC5FdmVudE5hbWUuUmVmcmVzaExpZ2h0LCB0aGlzLCB0aGlzLnJlZnJlc2hMaWdodClcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLnJlZ2lzdGVyQnRuRXZlbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELFxuICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBlID0gYy5VdGlscy5wb3NUcmFuc2Zvcm0odC5ub2RlLnBhcmVudCwgdC5ub2RlLmdldFBvc2l0aW9uKCksIHMuVUlNZ3IuZ2V0SW5zdGFuY2UoKS5nZXRVSVJvb3QobC5VSUlELlVJR2FtZSkpO1xuICAgICAgICAgICAgcy5VSU1nci5nZXRJbnN0YW5jZSgpLm9wZW5VSShsLlVJSUQuVUlGZXR0ZXJJbmZvLCAtMSwgdC5mZXR0ZXJJZCwgZSlcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLmluaXREYXRhID0gZnVuY3Rpb24odCkge1xuICAgICAgICB0aGlzLmZldHRlcklkID0gdCxcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KCksXG4gICAgICAgIHRoaXMucmVnaXN0ZXJCdG5FdmVudCgpXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5yZWZyZXNoRmV0dGVyU2hvdyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgdGhpcy5mZXR0ZXJJZCA9PT0gdCAmJiAodGhpcy5MYWJGZXR0ZXJOdW0uc3RyaW5nID0gdS5kZWZhdWx0LmdldEluc3RhbmNlKCkuZ2V0U3RyaW5nRm9yRmV0dGVySWQodGhpcy5mZXR0ZXJJZCkpXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5yZWZyZXNoTGlnaHQgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHRoaXMuZmV0dGVySWQgPT09IHQgJiYgdGhpcy5saWdodEFuaW0oKVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUubGlnaHRBbmltID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGNjLmlzVmFsaWQodGhpcy5TcFNlbGVjdCkgJiYgKHRoaXMuU3BTZWxlY3Qub3BhY2l0eSA9IDAsIGNjLnR3ZWVuKHRoaXMuU3BTZWxlY3QpLnRvKC4zLCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAyNTVcbiAgICAgICAgfSkudG8oLjgsIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IDEwMFxuICAgICAgICB9KS50byguNiwge1xuICAgICAgICAgICAgb3BhY2l0eTogMjU1XG4gICAgICAgIH0pLnRvKC41LCB7XG4gICAgICAgICAgICBvcGFjaXR5OiAwXG4gICAgICAgIH0pLnN0YXJ0KCkpXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5vbkRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgbi5FdmVudE1nci5nZXRJbnN0YW5jZSgpLm9mZihsLkV2ZW50TmFtZS5SZWZyZXNoRmV0dGVyU2hvdywgdGhpcywgdGhpcy5yZWZyZXNoRmV0dGVyU2hvdyksXG4gICAgICAgIG4uRXZlbnRNZ3IuZ2V0SW5zdGFuY2UoKS5vZmYobC5FdmVudE5hbWUuUmVmcmVzaExpZ2h0LCB0aGlzLCB0aGlzLnJlZnJlc2hMaWdodClcbiAgICB9LFxuICAgIHIoW2QoY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJTcFNlbGVjdFwiLCB2b2lkIDApLFxuICAgIHIoW2QoY2MuUmljaFRleHQpXSwgZS5wcm90b3R5cGUsIFwiTGFiRmV0dGVyTnVtXCIsIHZvaWQgMCksXG4gICAgcihbZ10sIGUpXG59IChjYy5Db21wb25lbnQpO1xuby5kZWZhdWx0ID0gaCJdfQ==