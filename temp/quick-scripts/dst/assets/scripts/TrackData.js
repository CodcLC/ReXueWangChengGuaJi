
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/TrackData.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '9c631X3YHpLT4DJJ6t4c0QE', 'TrackData');
// scripts/TrackData.js

"use strict";

var t = require;
var e = module;
var o = exports;

var _a,
    i = void 0 && (void 0).__extends || (_a = function a(t, e) {
  return (_a = Object.setPrototypeOf || {
    __proto__: []
  } instanceof Array && function (t, e) {
    t.__proto__ = e;
  } || function (t, e) {
    for (var o in e) {
      Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]);
    }
  })(t, e);
}, function (t, e) {
  function o() {
    this.constructor = t;
  }

  _a(t, e), t.prototype = null === e ? Object.create(e) : (o.prototype = e.prototype, new o());
});

Object.defineProperty(o, "__esModule", {
  value: !0
}), o.TrackData = void 0;

var r = t("BaseData"),
    n = t("BasePlatform"),
    s = t("HttpMgr"),
    c = t("PlatformManager"),
    l = t("SdkMgr"),
    u = t("TimeUtils"),
    p = t("Utils"),
    g = t("Config"),
    d = t("PlayerMgr"),
    h = t("TrackDataEvent"),
    f = function f() {
  this.abName = null, this.isGet = !1, this.versionName = null, this.appStore = 0, this.iCountStore = 0, this.iCountHC = 0;
},
    m = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    return e.ecrypt = !1, e.gameKey = g.GameConfig.AppCacheName + "trackdata", e.eventCF = {}, e;
  }

  return i(e, t), e.prototype.createData = function () {
    return this.data = new f(), this.data.versionName = this.getVersionConf(), this.saveData(), this.data;
  }, e.prototype.initData = function () {
    this.eventCF = h.EventCF;
  }, e.prototype.getVersionName = function () {
    return this.data.versionName ? this.data.versionName : this.getVersionConf();
  }, e.prototype.getVersionConf = function () {
    var t = c.UM_VERSION.versionName,
        e = l.SdkMgr.getInstance().getSwitchVersion(t);
    return e || (e = "1.0.0"), String(e);
  }, e.prototype.getSdkAbName = function (t, e) {
    var o = this;
    null != this.data.abName && this.data.isGet ? e && e(this.data.abName) : this.requestAbName(t, function (t) {
      o.data.isGet = !0, o.data.abName = null == t ? "C" : t, e && e(o.data.abName), o.saveData();
    });
  }, e.prototype.setToAppStore = function () {
    this.data.appStore = 1, this.saveData();
  }, e.prototype.getToAppStore = function () {
    return 1 == this.data.appStore;
  }, e.prototype.getAbType = function () {
    return this.data.abName ? this.data.abName : "C";
  }, e.prototype.requestAbName = function (t, e) {
    var o = this;

    if (t == d.ABTestType.NO_AB && (this.abTestUser = "C"), c.PlatformManager.currentPlatform == n.Platform.EDITOR) {
      var a = window.location.href.split("?abType=");
      if (a.length > 1) this.abTestUser = a[a.length - 1];else {
        var i = ["C"];
        t == d.ABTestType.AB_Test ? i = ["A", "B"] : t == d.ABTestType.AD_Test ? i = ["A", "D"] : t == d.ABTestType.ABD_Test && (i = ["A", "B", "D"]);
        var r = p.Utils.randomRang(0, i.length);
        this.abTestUser = i[r];
      }
    }

    t == d.ABTestType.A_fixed || c.PlatformManager.currentPlatform == n.Platform.ANDROID_TAP || c.PlatformManager.currentPlatform == n.Platform.WEB_LINK || c.PlatformManager.currentPlatform == n.Platform.ANDROID_233 || c.PlatformManager.currentPlatform == n.Platform.GOOGLE ? this.abTestUser = "A" : t == d.ABTestType.B_fixed ? this.abTestUser = "B" : t == d.ABTestType.D_fixed && (this.abTestUser = "D"), this.abTestUser ? e(this.abTestUser) : s.HttpMgr.getInstance().httpPost({
      appId: c.PlatformInfo.APP_ID,
      platform: c.PlatformManager.currentPlatform
    }, function (t) {
      if (null == t) o.abTestUser = "C";else {
        var a,
            i = JSON.parse(t);
        a = 1 == i.data ? ["A", "B", "D"] : 2 == i.data ? ["A"] : 3 == i.data ? ["B"] : 4 == i.data ? ["D"] : 5 == i.data ? ["A", "B"] : 6 == i.data ? ["A", "D"] : 7 == i.data ? ["B", "D"] : ["C"], o.abTestUser = a[Math.floor(Math.random() * a.length)];
      }
      e && e(o.abTestUser);
    }, "https://yuema.sfplay.net:9090/getPlatformInfo2");
  }, e.prototype.youmengTrack = function (t, e, o) {
    var a = this.eventCF[t],
        i = !0,
        r = a.eventValue;

    if (e && (r += e), o && (r = r + "_" + o), !a.condition || !this.data[a.condition]) {
      if (a.preEvent && !e) {
        if (!this.data[a.preEvent]) return;
      } else if (a.preEvent && e && !this.data[a.preEvent + e]) return;

      if (a.onlyOne && this.data[a.eventKey + r] && (i = !1), !(i && a.saveKey && this.data[a.eventKey + a.eventValue])) {
        if (t == h.TrackId.dau) {
          var n = this.data[a.eventKey + a.eventValue];

          if (n) {
            var s = Number(n);
            if (u.TimeUtils.compareIsToday(s)) return;
            i = !0;
          } else i = !0;
        }

        i && (a.onlyOne && (a.saveKey ? this.data[a.eventKey + a.eventValue] = 1 : this.data[a.eventKey + r] = 1, t == h.TrackId.dau && (this.data[a.eventKey + a.eventValue] = u.TimeUtils.GetTimeBySecond()), this.saveData()), this.data.abName || (this.data.abName = "C", this.saveData()), c.PlatformManager.getInstance().youmengTrack(a.eventKey, "user" + this.data.abName, this.getVersionName() + "_" + r, a.info));
      }
    }
  }, e.prototype.youmengTrackNew = function () {}, e.prototype.testTrackTime = function () {}, e.prototype.getCountStore = function () {
    return null == this.data.iCountStore && (this.data.iCountStore = 0), this.data.iCountStore;
  }, e.prototype.addCountStore = function (t) {
    void 0 === t && (t = 1), null == this.data.iCountStore && (this.data.iCountStore = 0), this.data.iCountStore += t, this.saveData();
  }, e.prototype.getCountHC = function () {
    return null == this.data.iCountHC && (this.data.iCountHC = 0), this.data.iCountHC;
  }, e.prototype.addCountHC = function (t) {
    void 0 === t && (t = 1), null == this.data.iCountHC && (this.data.iCountHC = 0), this.data.iCountHC += t, this.saveData();
  }, e;
}(r.BaseData);

o.TrackData = m;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcVHJhY2tEYXRhLmpzIl0sIm5hbWVzIjpbInQiLCJyZXF1aXJlIiwiZSIsIm1vZHVsZSIsIm8iLCJleHBvcnRzIiwiYSIsImkiLCJfX2V4dGVuZHMiLCJPYmplY3QiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIkFycmF5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiY29uc3RydWN0b3IiLCJjcmVhdGUiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiVHJhY2tEYXRhIiwiciIsIm4iLCJzIiwiYyIsImwiLCJ1IiwicCIsImciLCJkIiwiaCIsImYiLCJhYk5hbWUiLCJpc0dldCIsInZlcnNpb25OYW1lIiwiYXBwU3RvcmUiLCJpQ291bnRTdG9yZSIsImlDb3VudEhDIiwibSIsImFwcGx5IiwiYXJndW1lbnRzIiwiZWNyeXB0IiwiZ2FtZUtleSIsIkdhbWVDb25maWciLCJBcHBDYWNoZU5hbWUiLCJldmVudENGIiwiY3JlYXRlRGF0YSIsImRhdGEiLCJnZXRWZXJzaW9uQ29uZiIsInNhdmVEYXRhIiwiaW5pdERhdGEiLCJFdmVudENGIiwiZ2V0VmVyc2lvbk5hbWUiLCJVTV9WRVJTSU9OIiwiU2RrTWdyIiwiZ2V0SW5zdGFuY2UiLCJnZXRTd2l0Y2hWZXJzaW9uIiwiU3RyaW5nIiwiZ2V0U2RrQWJOYW1lIiwicmVxdWVzdEFiTmFtZSIsInNldFRvQXBwU3RvcmUiLCJnZXRUb0FwcFN0b3JlIiwiZ2V0QWJUeXBlIiwiQUJUZXN0VHlwZSIsIk5PX0FCIiwiYWJUZXN0VXNlciIsIlBsYXRmb3JtTWFuYWdlciIsImN1cnJlbnRQbGF0Zm9ybSIsIlBsYXRmb3JtIiwiRURJVE9SIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwic3BsaXQiLCJsZW5ndGgiLCJBQl9UZXN0IiwiQURfVGVzdCIsIkFCRF9UZXN0IiwiVXRpbHMiLCJyYW5kb21SYW5nIiwiQV9maXhlZCIsIkFORFJPSURfVEFQIiwiV0VCX0xJTksiLCJBTkRST0lEXzIzMyIsIkdPT0dMRSIsIkJfZml4ZWQiLCJEX2ZpeGVkIiwiSHR0cE1nciIsImh0dHBQb3N0IiwiYXBwSWQiLCJQbGF0Zm9ybUluZm8iLCJBUFBfSUQiLCJwbGF0Zm9ybSIsIkpTT04iLCJwYXJzZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInlvdW1lbmdUcmFjayIsImV2ZW50VmFsdWUiLCJjb25kaXRpb24iLCJwcmVFdmVudCIsIm9ubHlPbmUiLCJldmVudEtleSIsInNhdmVLZXkiLCJUcmFja0lkIiwiZGF1IiwiTnVtYmVyIiwiVGltZVV0aWxzIiwiY29tcGFyZUlzVG9kYXkiLCJHZXRUaW1lQnlTZWNvbmQiLCJpbmZvIiwieW91bWVuZ1RyYWNrTmV3IiwidGVzdFRyYWNrVGltZSIsImdldENvdW50U3RvcmUiLCJhZGRDb3VudFN0b3JlIiwiZ2V0Q291bnRIQyIsImFkZENvdW50SEMiLCJCYXNlRGF0YSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFDLEdBQUdDLE9BQVI7QUFDQSxJQUFJQyxDQUFDLEdBQUdDLE1BQVI7QUFDQSxJQUFJQyxDQUFDLEdBQUdDLE9BQVI7O0FBQ0EsSUFBSUMsRUFBSjtBQUFBLElBQU9DLENBQUMsR0FBRyxVQUFRLFNBQUtDLFNBQWIsS0FBMkJGLEVBQUMsR0FBRyxXQUFTTixDQUFULEVBQVlFLENBQVosRUFBZTtFQUNyRCxPQUFPLENBQUNJLEVBQUMsR0FBR0csTUFBTSxDQUFDQyxjQUFQLElBQXlCO0lBQ2pDQyxTQUFTLEVBQUU7RUFEc0IsYUFHMUJDLEtBSDBCLElBSXJDLFVBQVNaLENBQVQsRUFBWUUsQ0FBWixFQUFlO0lBQ1hGLENBQUMsQ0FBQ1csU0FBRixHQUFjVCxDQUFkO0VBQ0gsQ0FOVyxJQU9aLFVBQVNGLENBQVQsRUFBWUUsQ0FBWixFQUFlO0lBQ1gsS0FBSyxJQUFJRSxDQUFULElBQWNGLENBQWQ7TUFBaUJPLE1BQU0sQ0FBQ0ksU0FBUCxDQUFpQkMsY0FBakIsQ0FBZ0NDLElBQWhD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RCxRQUFMLEVBSEE7RUFJSCxDQW5HTSxFQW9HUC9DLENBQUMsQ0FBQ1csU0FBRixDQUFZdUcsVUFBWixHQUF5QixZQUFXO0lBQ2hDLE9BQU8sUUFBUSxLQUFLckUsSUFBTCxDQUFVVixRQUFsQixLQUErQixLQUFLVSxJQUFMLENBQVVWLFFBQVYsR0FBcUIsQ0FBcEQsR0FDUCxLQUFLVSxJQUFMLENBQVVWLFFBRFY7RUFFSCxDQXZHTSxFQXdHUG5DLENBQUMsQ0FBQ1csU0FBRixDQUFZd0csVUFBWixHQUF5QixVQUFTckgsQ0FBVCxFQUFZO0lBQ2pDLEtBQUssQ0FBTCxLQUFXQSxDQUFYLEtBQWlCQSxDQUFDLEdBQUcsQ0FBckIsR0FDQSxRQUFRLEtBQUsrQyxJQUFMLENBQVVWLFFBQWxCLEtBQStCLEtBQUtVLElBQUwsQ0FBVVYsUUFBVixHQUFxQixDQUFwRCxDQURBLEVBRUEsS0FBS1UsSUFBTCxDQUFVVixRQUFWLElBQXNCckMsQ0FGdEIsRUFHQSxLQUFLaUQsUUFBTCxFQUhBO0VBSUgsQ0E3R00sRUE4R1AvQyxDQTlHQTtBQStHSCxDQXZIRyxDQXVIRG1CLENBQUMsQ0FBQ2lHLFFBdkhELENBbEJKOztBQTBJQWxILENBQUMsQ0FBQ2dCLFNBQUYsR0FBY2tCLENBQWQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciB0ID0gcmVxdWlyZTtcbnZhciBlID0gbW9kdWxlO1xudmFyIG8gPSBleHBvcnRzO1xudmFyIGEsIGkgPSB0aGlzICYmIHRoaXMuX19leHRlbmRzIHx8IChhID0gZnVuY3Rpb24odCwgZSkge1xuICAgIHJldHVybiAoYSA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7XG4gICAgICAgIF9fcHJvdG9fXzogW11cbiAgICB9XG4gICAgaW5zdGFuY2VvZiBBcnJheSAmJlxuICAgIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgdC5fX3Byb3RvX18gPSBlXG4gICAgfSB8fFxuICAgIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgZm9yICh2YXIgbyBpbiBlKSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSwgbykgJiYgKHRbb10gPSBlW29dKVxuICAgIH0pKHQsIGUpXG59LFxuZnVuY3Rpb24odCwgZSkge1xuICAgIGZ1bmN0aW9uIG8oKSB7XG4gICAgICAgIHRoaXMuY29uc3RydWN0b3IgPSB0XG4gICAgfVxuICAgIGEodCwgZSksXG4gICAgdC5wcm90b3R5cGUgPSBudWxsID09PSBlID8gT2JqZWN0LmNyZWF0ZShlKSA6IChvLnByb3RvdHlwZSA9IGUucHJvdG90eXBlLCBuZXcgbylcbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6ICEwXG59KSxcbm8uVHJhY2tEYXRhID0gdm9pZCAwO1xudmFyIHIgPSB0KFwiQmFzZURhdGFcIiksXG5uID0gdChcIkJhc2VQbGF0Zm9ybVwiKSxcbnMgPSB0KFwiSHR0cE1nclwiKSxcbmMgPSB0KFwiUGxhdGZvcm1NYW5hZ2VyXCIpLFxubCA9IHQoXCJTZGtNZ3JcIiksXG51ID0gdChcIlRpbWVVdGlsc1wiKSxcbnAgPSB0KFwiVXRpbHNcIiksXG5nID0gdChcIkNvbmZpZ1wiKSxcbmQgPSB0KFwiUGxheWVyTWdyXCIpLFxuaCA9IHQoXCJUcmFja0RhdGFFdmVudFwiKSxcbmYgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmFiTmFtZSA9IG51bGwsXG4gICAgdGhpcy5pc0dldCA9ICExLFxuICAgIHRoaXMudmVyc2lvbk5hbWUgPSBudWxsLFxuICAgIHRoaXMuYXBwU3RvcmUgPSAwLFxuICAgIHRoaXMuaUNvdW50U3RvcmUgPSAwLFxuICAgIHRoaXMuaUNvdW50SEMgPSAwXG59LFxubSA9IGZ1bmN0aW9uKHQpIHtcbiAgICBmdW5jdGlvbiBlKCkge1xuICAgICAgICB2YXIgZSA9IG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIHJldHVybiBlLmVjcnlwdCA9ICExLFxuICAgICAgICBlLmdhbWVLZXkgPSBnLkdhbWVDb25maWcuQXBwQ2FjaGVOYW1lICsgXCJ0cmFja2RhdGFcIixcbiAgICAgICAgZS5ldmVudENGID0ge30sXG4gICAgICAgIGVcbiAgICB9XG4gICAgcmV0dXJuIGkoZSwgdCksXG4gICAgZS5wcm90b3R5cGUuY3JlYXRlRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhID0gbmV3IGYsXG4gICAgICAgIHRoaXMuZGF0YS52ZXJzaW9uTmFtZSA9IHRoaXMuZ2V0VmVyc2lvbkNvbmYoKSxcbiAgICAgICAgdGhpcy5zYXZlRGF0YSgpLFxuICAgICAgICB0aGlzLmRhdGFcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLmluaXREYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuZXZlbnRDRiA9IGguRXZlbnRDRlxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUuZ2V0VmVyc2lvbk5hbWUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS52ZXJzaW9uTmFtZSA/IHRoaXMuZGF0YS52ZXJzaW9uTmFtZTogdGhpcy5nZXRWZXJzaW9uQ29uZigpXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5nZXRWZXJzaW9uQ29uZiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdCA9IGMuVU1fVkVSU0lPTi52ZXJzaW9uTmFtZSxcbiAgICAgICAgZSA9IGwuU2RrTWdyLmdldEluc3RhbmNlKCkuZ2V0U3dpdGNoVmVyc2lvbih0KTtcbiAgICAgICAgcmV0dXJuIGUgfHwgKGUgPSBcIjEuMC4wXCIpLFxuICAgICAgICBTdHJpbmcoZSlcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLmdldFNka0FiTmFtZSA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgdmFyIG8gPSB0aGlzO1xuICAgICAgICBudWxsICE9IHRoaXMuZGF0YS5hYk5hbWUgJiYgdGhpcy5kYXRhLmlzR2V0ID8gZSAmJiBlKHRoaXMuZGF0YS5hYk5hbWUpIDogdGhpcy5yZXF1ZXN0QWJOYW1lKHQsXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIG8uZGF0YS5pc0dldCA9ICEwLFxuICAgICAgICAgICAgby5kYXRhLmFiTmFtZSA9IG51bGwgPT0gdCA/IFwiQ1wiOiB0LFxuICAgICAgICAgICAgZSAmJiBlKG8uZGF0YS5hYk5hbWUpLFxuICAgICAgICAgICAgby5zYXZlRGF0YSgpXG4gICAgICAgIH0pXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5zZXRUb0FwcFN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuZGF0YS5hcHBTdG9yZSA9IDEsXG4gICAgICAgIHRoaXMuc2F2ZURhdGEoKVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUuZ2V0VG9BcHBTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gMSA9PSB0aGlzLmRhdGEuYXBwU3RvcmVcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLmdldEFiVHlwZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmFiTmFtZSA/IHRoaXMuZGF0YS5hYk5hbWU6IFwiQ1wiXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5yZXF1ZXN0QWJOYW1lID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICB2YXIgbyA9IHRoaXM7XG4gICAgICAgIGlmICh0ID09IGQuQUJUZXN0VHlwZS5OT19BQiAmJiAodGhpcy5hYlRlc3RVc2VyID0gXCJDXCIpLCBjLlBsYXRmb3JtTWFuYWdlci5jdXJyZW50UGxhdGZvcm0gPT0gbi5QbGF0Zm9ybS5FRElUT1IpIHtcbiAgICAgICAgICAgIHZhciBhID0gd2luZG93LmxvY2F0aW9uLmhyZWYuc3BsaXQoXCI/YWJUeXBlPVwiKTtcbiAgICAgICAgICAgIGlmIChhLmxlbmd0aCA+IDEpIHRoaXMuYWJUZXN0VXNlciA9IGFbYS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBpID0gW1wiQ1wiXTtcbiAgICAgICAgICAgICAgICB0ID09IGQuQUJUZXN0VHlwZS5BQl9UZXN0ID8gaSA9IFtcIkFcIiwgXCJCXCJdIDogdCA9PSBkLkFCVGVzdFR5cGUuQURfVGVzdCA/IGkgPSBbXCJBXCIsIFwiRFwiXSA6IHQgPT0gZC5BQlRlc3RUeXBlLkFCRF9UZXN0ICYmIChpID0gW1wiQVwiLCBcIkJcIiwgXCJEXCJdKTtcbiAgICAgICAgICAgICAgICB2YXIgciA9IHAuVXRpbHMucmFuZG9tUmFuZygwLCBpLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hYlRlc3RVc2VyID0gaVtyXVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHQgPT0gZC5BQlRlc3RUeXBlLkFfZml4ZWQgfHwgYy5QbGF0Zm9ybU1hbmFnZXIuY3VycmVudFBsYXRmb3JtID09IG4uUGxhdGZvcm0uQU5EUk9JRF9UQVAgfHwgYy5QbGF0Zm9ybU1hbmFnZXIuY3VycmVudFBsYXRmb3JtID09IG4uUGxhdGZvcm0uV0VCX0xJTksgfHwgYy5QbGF0Zm9ybU1hbmFnZXIuY3VycmVudFBsYXRmb3JtID09IG4uUGxhdGZvcm0uQU5EUk9JRF8yMzMgfHwgYy5QbGF0Zm9ybU1hbmFnZXIuY3VycmVudFBsYXRmb3JtID09IG4uUGxhdGZvcm0uR09PR0xFID8gdGhpcy5hYlRlc3RVc2VyID0gXCJBXCI6IHQgPT0gZC5BQlRlc3RUeXBlLkJfZml4ZWQgPyB0aGlzLmFiVGVzdFVzZXIgPSBcIkJcIjogdCA9PSBkLkFCVGVzdFR5cGUuRF9maXhlZCAmJiAodGhpcy5hYlRlc3RVc2VyID0gXCJEXCIpLFxuICAgICAgICB0aGlzLmFiVGVzdFVzZXIgPyBlKHRoaXMuYWJUZXN0VXNlcikgOiBzLkh0dHBNZ3IuZ2V0SW5zdGFuY2UoKS5odHRwUG9zdCh7XG4gICAgICAgICAgICBhcHBJZDogYy5QbGF0Zm9ybUluZm8uQVBQX0lELFxuICAgICAgICAgICAgcGxhdGZvcm06IGMuUGxhdGZvcm1NYW5hZ2VyLmN1cnJlbnRQbGF0Zm9ybVxuICAgICAgICB9LFxuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBpZiAobnVsbCA9PSB0KSBvLmFiVGVzdFVzZXIgPSBcIkNcIjtcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBhLCBpID0gSlNPTi5wYXJzZSh0KTtcbiAgICAgICAgICAgICAgICBhID0gMSA9PSBpLmRhdGEgPyBbXCJBXCIsIFwiQlwiLCBcIkRcIl0gOiAyID09IGkuZGF0YSA/IFtcIkFcIl0gOiAzID09IGkuZGF0YSA/IFtcIkJcIl0gOiA0ID09IGkuZGF0YSA/IFtcIkRcIl0gOiA1ID09IGkuZGF0YSA/IFtcIkFcIiwgXCJCXCJdIDogNiA9PSBpLmRhdGEgPyBbXCJBXCIsIFwiRFwiXSA6IDcgPT0gaS5kYXRhID8gW1wiQlwiLCBcIkRcIl0gOiBbXCJDXCJdLFxuICAgICAgICAgICAgICAgIG8uYWJUZXN0VXNlciA9IGFbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYS5sZW5ndGgpXVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZSAmJiBlKG8uYWJUZXN0VXNlcilcbiAgICAgICAgfSxcbiAgICAgICAgXCJodHRwczovL3l1ZW1hLnNmcGxheS5uZXQ6OTA5MC9nZXRQbGF0Zm9ybUluZm8yXCIpXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS55b3VtZW5nVHJhY2sgPSBmdW5jdGlvbih0LCBlLCBvKSB7XG4gICAgICAgIHZhciBhID0gdGhpcy5ldmVudENGW3RdLFxuICAgICAgICBpID0gITAsXG4gICAgICAgIHIgPSBhLmV2ZW50VmFsdWU7XG4gICAgICAgIGlmIChlICYmIChyICs9IGUpLCBvICYmIChyID0gciArIFwiX1wiICsgbyksICFhLmNvbmRpdGlvbiB8fCAhdGhpcy5kYXRhW2EuY29uZGl0aW9uXSkge1xuICAgICAgICAgICAgaWYgKGEucHJlRXZlbnQgJiYgIWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGF0YVthLnByZUV2ZW50XSkgcmV0dXJuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGEucHJlRXZlbnQgJiYgZSAmJiAhdGhpcy5kYXRhW2EucHJlRXZlbnQgKyBlXSkgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKGEub25seU9uZSAmJiB0aGlzLmRhdGFbYS5ldmVudEtleSArIHJdICYmIChpID0gITEpLCAhKGkgJiYgYS5zYXZlS2V5ICYmIHRoaXMuZGF0YVthLmV2ZW50S2V5ICsgYS5ldmVudFZhbHVlXSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodCA9PSBoLlRyYWNrSWQuZGF1KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuID0gdGhpcy5kYXRhW2EuZXZlbnRLZXkgKyBhLmV2ZW50VmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBOdW1iZXIobik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodS5UaW1lVXRpbHMuY29tcGFyZUlzVG9kYXkocykpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAhMFxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaSA9ICEwXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGkgJiYgKGEub25seU9uZSAmJiAoYS5zYXZlS2V5ID8gdGhpcy5kYXRhW2EuZXZlbnRLZXkgKyBhLmV2ZW50VmFsdWVdID0gMSA6IHRoaXMuZGF0YVthLmV2ZW50S2V5ICsgcl0gPSAxLCB0ID09IGguVHJhY2tJZC5kYXUgJiYgKHRoaXMuZGF0YVthLmV2ZW50S2V5ICsgYS5ldmVudFZhbHVlXSA9IHUuVGltZVV0aWxzLkdldFRpbWVCeVNlY29uZCgpKSwgdGhpcy5zYXZlRGF0YSgpKSwgdGhpcy5kYXRhLmFiTmFtZSB8fCAodGhpcy5kYXRhLmFiTmFtZSA9IFwiQ1wiLCB0aGlzLnNhdmVEYXRhKCkpLCBjLlBsYXRmb3JtTWFuYWdlci5nZXRJbnN0YW5jZSgpLnlvdW1lbmdUcmFjayhhLmV2ZW50S2V5LCBcInVzZXJcIiArIHRoaXMuZGF0YS5hYk5hbWUsIHRoaXMuZ2V0VmVyc2lvbk5hbWUoKSArIFwiX1wiICsgciwgYS5pbmZvKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUueW91bWVuZ1RyYWNrTmV3ID0gZnVuY3Rpb24oKSB7fSxcbiAgICBlLnByb3RvdHlwZS50ZXN0VHJhY2tUaW1lID0gZnVuY3Rpb24oKSB7fSxcbiAgICBlLnByb3RvdHlwZS5nZXRDb3VudFN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBudWxsID09IHRoaXMuZGF0YS5pQ291bnRTdG9yZSAmJiAodGhpcy5kYXRhLmlDb3VudFN0b3JlID0gMCksXG4gICAgICAgIHRoaXMuZGF0YS5pQ291bnRTdG9yZVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUuYWRkQ291bnRTdG9yZSA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgdm9pZCAwID09PSB0ICYmICh0ID0gMSksXG4gICAgICAgIG51bGwgPT0gdGhpcy5kYXRhLmlDb3VudFN0b3JlICYmICh0aGlzLmRhdGEuaUNvdW50U3RvcmUgPSAwKSxcbiAgICAgICAgdGhpcy5kYXRhLmlDb3VudFN0b3JlICs9IHQsXG4gICAgICAgIHRoaXMuc2F2ZURhdGEoKVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUuZ2V0Q291bnRIQyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbnVsbCA9PSB0aGlzLmRhdGEuaUNvdW50SEMgJiYgKHRoaXMuZGF0YS5pQ291bnRIQyA9IDApLFxuICAgICAgICB0aGlzLmRhdGEuaUNvdW50SENcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLmFkZENvdW50SEMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHZvaWQgMCA9PT0gdCAmJiAodCA9IDEpLFxuICAgICAgICBudWxsID09IHRoaXMuZGF0YS5pQ291bnRIQyAmJiAodGhpcy5kYXRhLmlDb3VudEhDID0gMCksXG4gICAgICAgIHRoaXMuZGF0YS5pQ291bnRIQyArPSB0LFxuICAgICAgICB0aGlzLnNhdmVEYXRhKClcbiAgICB9LFxuICAgIGVcbn0gKHIuQmFzZURhdGEpO1xuby5UcmFja0RhdGEgPSBtIl19