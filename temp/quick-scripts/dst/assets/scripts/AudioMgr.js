
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/AudioMgr.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '01e28yg0bJGMoJ+TmUHgvk/', 'AudioMgr');
// scripts/AudioMgr.js

"use strict";

var t = require;
var e = module;
var o = exports;

var _a,
    i = void 0 && (void 0).__extends || (_a = function a(t, e) {
  return (_a = Object.setPrototypeOf || {
    __proto__: []
  } instanceof Array && function (t, e) {
    t.__proto__ = e;
  } || function (t, e) {
    for (var o in e) {
      Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]);
    }
  })(t, e);
}, function (t, e) {
  function o() {
    this.constructor = t;
  }

  _a(t, e), t.prototype = null === e ? Object.create(e) : (o.prototype = e.prototype, new o());
});

Object.defineProperty(o, "__esModule", {
  value: !0
}), o.AudioMgr = void 0;

var r = t("Config"),
    n = t("BaseMgr"),
    s = t("CacheUtils"),
    c = t("LogMgr"),
    l = t("ResourceMgr"),
    u = function (t) {
  function e() {
    var e = t.call(this) || this;
    return e.audioSourceMap = new Map(), e.audioClipMap = new Map(), e.ADConf = {}, e.otherADConf = [], e.musicKeys = [], e;
  }

  return i(e, t), e.getInstance = function () {
    return null == this.instance && (this.instance = new e()), this.instance;
  }, e.prototype.init = function (t) {
    this.ADConf = t, this.setButtonNomalAudio(r.AudioId.btnClick);
  }, e.prototype.loadAudio = function (t, e) {
    var o = this,
        a = this.getAdConf(t);
    a ? l.ResourceMgr.getInstance().loadRes(a.bundle, a.path, cc.AudioClip, function (t) {
      o.audioClipMap.set(a.path, t), e && e();
    }) : c.LogMgr.getInstance().error("音效没有配置：", t);
  }, e.prototype.addAdConf = function (t) {
    this.otherADConf.push(t);
  }, e.prototype.getAdConf = function (t) {
    var e = this.ADConf[t];
    if (e) return e;

    for (var o = 0; o < this.otherADConf.length; o++) {
      var a = this.otherADConf[o][t];
      if (a) return a;
    }

    return null;
  }, e.prototype.addMusicKey = function (t) {
    for (var e = 0; e < this.musicKeys.length; e++) {
      if (this.musicKeys[e] == t) return !1;
    }

    return this.musicKeys.push(t), !0;
  }, e.prototype.removeMusicKey = function (t) {
    for (var e = 0; e < this.musicKeys.length; e++) {
      if (this.musicKeys[e] == t) return this.musicKeys.splice(e, 1), !0;
    }

    return !1;
  }, e.prototype.creatreAudioSource = function (t) {
    var e = new cc.AudioSource();
    return this.audioSourceMap.has(t) && this.audioSourceMap.get(t).destroy(), this.audioSourceMap.set(t, e), e;
  }, e.prototype.getAudioSource = function (t) {
    return this.audioSourceMap.has(t) ? this.audioSourceMap.get(t) : this.creatreAudioSource(t);
  }, e.prototype.playMusic = function (t, e, o, a) {
    var i = this;

    if (void 0 === o && (o = !0), void 0 === a && (a = 1), s.CacheUtils.canPlayMusin()) {
      var r = this.getAudioSource(e);
      if (null == r) return void c.LogMgr.getInstance().error("audioSourceName：" + e + "不存在");
      r.stop();
      var n = this.getAdConf(t);
      if (null == n) return void c.LogMgr.getInstance().error("audio id:" + t + "不存在");

      if (o && this.addMusicKey(e), this.audioClipMap.has(n.path)) {
        var u = this.audioClipMap.get(n.path);
        r.clip = u, r.loop = o, r.volume = a, r.play();
      } else l.ResourceMgr.getInstance().loadRes(n.bundle, n.path, cc.AudioClip, function (t) {
        r.clip = t, i.audioClipMap.set(n.path, t), r.loop = o, r.volume = a, r.play();
      });
    }
  }, e.prototype.pauseMusic = function (t) {
    if (s.CacheUtils.canPlayMusin()) {
      var e = this.getAudioSource(t);
      if (null == e) return void c.LogMgr.getInstance().error("audioSourceName：" + t + "不存在");
      e.pause();
    }
  }, e.prototype.resumeMusic = function (t) {
    if (s.CacheUtils.canPlayMusin()) {
      var e = this.getAudioSource(t);
      if (null == e) return void c.LogMgr.getInstance().error("audioSourceName：" + t + "不存在");
      e.resume();
    }
  }, e.prototype.pauseAllMusic = function () {
    var t = this;
    this.musicKeys.forEach(function (e) {
      t.pauseMusic(e);
    });
  }, e.prototype.resumeAllMusic = function () {
    var t = this;
    this.musicKeys.forEach(function (e) {
      t.resumeMusic(e);
    });
  }, e.prototype.stopMusic = function (t) {
    var e = this.getAudioSource(t);
    null != e ? (this.removeMusicKey(t), e.stop()) : c.LogMgr.getInstance().error("audioSourceName：" + t + "不存在");
  }, e.prototype.stopAll = function () {
    this.audioSourceMap.forEach(function (t) {
      t.stop();
    });
  }, e.prototype.playEffect = function (t, e) {
    var o = this;

    if (void 0 === e && (e = 1), s.CacheUtils.canPlayEffect()) {
      var a = this.EffectAduioSource;
      null == a && (a = this.getAudioSource("effect"));
      var i = this.getAdConf(t);

      if (this.audioClipMap.has(i.path)) {
        var r = this.audioClipMap.get(i.path);
        a.clip = r, a.volume = e, a.play();
      } else l.ResourceMgr.getInstance().loadRes(i.bundle, i.path, cc.AudioClip, function (t) {
        o.audioClipMap.set(i.path, t), a.clip = t, a.volume = e, a.play();
      });
    }
  }, e.prototype.playEffectByPath = function (t, e, o, a) {
    var i = this;

    if (void 0 === o && (o = 1), void 0 === a && (a = !1), s.CacheUtils.canPlayEffect()) {
      var r = this.EffectAduioSource;

      if (null == r && (r = this.getAudioSource(e)), this.audioClipMap.has(t)) {
        var n = this.audioClipMap.get(t);
        r.clip = n, r.volume = o, r.loop = a, r.play();
      } else l.ResourceMgr.getInstance().loadRes("audio", t, cc.AudioClip, function (e) {
        i.audioClipMap.set(t, e), r.clip = e, r.volume = o, r.loop = a, r.play();
      });
    }
  }, e.prototype.playAudioFromPath = function (t, e, o, a, i) {
    var r = this;

    if (s.CacheUtils.canPlayMusin()) {
      var n = this.getAudioSource(o);
      if (null == n) return void c.LogMgr.getInstance().error("audioSourceName：" + o + "不存在");

      if (n.stop(), this.audioClipMap.has(e)) {
        var u = this.audioClipMap.get(e);
        n.clip = u, n.volume = 1, a ? (n.loop = !0, this.addMusicKey(o)) : n.loop = !1, n.play(), i && i(n);
      } else l.ResourceMgr.getInstance().loadRes(t, String(e), cc.AudioClip, function (t) {
        n.clip = t, r.audioClipMap.set(e, t), n.volume = 1, a ? (n.loop = !0, r.addMusicKey(o)) : n.loop = !1, n.play(), i && i(n);
      });
    }
  }, e.prototype.stopEffect = function () {
    var t = this.getAudioSource("effect");
    t && t.stop();
  }, e.prototype.setButtonNomalAudio = function (t) {
    this.normalButtonAudio = t;
  }, e.prototype.playAudioButtonClicked = function () {
    this.normalButtonAudio && this.playEffect(this.normalButtonAudio);
  }, e;
}(n["default"]);

o.AudioMgr = u;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcQXVkaW9NZ3IuanMiXSwibmFtZXMiOlsidCIsInJlcXVpcmUiLCJlIiwibW9kdWxlIiwibyIsImV4cG9ydHMiLCJhIiwiaSIsIl9fZXh0ZW5kcyIsIk9iamVjdCIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJjb25zdHJ1Y3RvciIsImNyZWF0ZSIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJBdWRpb01nciIsInIiLCJuIiwicyIsImMiLCJsIiwidSIsImF1ZGlvU291cmNlTWFwIiwiTWFwIiwiYXVkaW9DbGlwTWFwIiwiQURDb25mIiwib3RoZXJBRENvbmYiLCJtdXNpY0tleXMiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwiaW5pdCIsInNldEJ1dHRvbk5vbWFsQXVkaW8iLCJBdWRpb0lkIiwiYnRuQ2xpY2siLCJsb2FkQXVkaW8iLCJnZXRBZENvbmYiLCJSZXNvdXJjZU1nciIsImxvYWRSZXMiLCJidW5kbGUiLCJwYXRoIiwiY2MiLCJBdWRpb0NsaXAiLCJzZXQiLCJMb2dNZ3IiLCJlcnJvciIsImFkZEFkQ29uZiIsInB1c2giLCJsZW5ndGgiLCJhZGRNdXNpY0tleSIsInJlbW92ZU11c2ljS2V5Iiwic3BsaWNlIiwiY3JlYXRyZUF1ZGlvU291cmNlIiwiQXVkaW9Tb3VyY2UiLCJoYXMiLCJnZXQiLCJkZXN0cm95IiwiZ2V0QXVkaW9Tb3VyY2UiLCJwbGF5TXVzaWMiLCJDYWNoZVV0aWxzIiwiY2FuUGxheU11c2luIiwic3RvcCIsImNsaXAiLCJsb29wIiwidm9sdW1lIiwicGxheSIsInBhdXNlTXVzaWMiLCJwYXVzZSIsInJlc3VtZU11c2ljIiwicmVzdW1lIiwicGF1c2VBbGxNdXNpYyIsImZvckVhY2giLCJyZXN1bWVBbGxNdXNpYyIsInN0b3BNdXNpYyIsInN0b3BBbGwiLCJwbGF5RWZmZWN0IiwiY2FuUGxheUVmZmVjdCIsIkVmZmVjdEFkdWlvU291cmNlIiwicGxheUVmZmVjdEJ5UGF0aCIsInBsYXlBdWRpb0Zyb21QYXRoIiwiU3RyaW5nIiwic3RvcEVmZmVjdCIsIm5vcm1hbEJ1dHRvbkF1ZGlvIiwicGxheUF1ZGlvQnV0dG9uQ2xpY2tlZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFDLEdBQUdDLE9BQVI7QUFDQSxJQUFJQyxDQUFDLEdBQUdDLE1BQVI7QUFDQSxJQUFJQyxDQUFDLEdBQUdDLE9BQVI7O0FBQ0EsSUFBSUMsRUFBSjtBQUFBLElBQU9DLENBQUMsR0FBRyxVQUFRLFNBQUtDLFNBQWIsS0FBMkJGLEVBQUMsR0FBRyxXQUFTTixDQUFULEVBQVlFLENBQVosRUFBZTtFQUNyRCxPQUFPLENBQUNJLEVBQUMsR0FBR0csTUFBTSxDQUFDQyxjQUFQLElBQXlCO0lBQ2pDQyxTQUFTLEVBQUU7RUFEc0IsYUFHMUJDLEtBSDBCLElBSXJDLFVBQVNaLENBQVQsRUFBWUUsQ0FBWixFQUFlO0lBQ1hGLENBQUMsQ0FBQ1csU0FBRixHQUFjVCxDQUFkO0VBQ0gsQ0FOVyxJQU9aLFVBQVNGLENBQVQsRUFBWUUsQ0FBWixFQUFlO0lBQ1gsS0FBSyxJQUFJRSxDQUFULElBQWNGLENBQWQ7TUFBaUJPLE1BQU0sQ0FBQ0ksU0FBUCxDQUFpQkMsY0FBakIsQ0FBZ0NDLElBQWhDLENBQXFDYixDQUFyQyxFQUF3Q0UsQ0FBeEMsTUFBK0NKLENBQUMsQ0FBQ0ksQ0FBRCxDQUFELEdBQU9GLENBQUMsQ0FBQ0UsQ0FBRCxDQUF2RDtJQUFqQjtFQUNILENBVE0sRUFTSkosQ0FUSSxFQVNERSxDQVRDLENBQVA7QUFVSCxDQVhxQyxFQVl0QyxVQUFTRixDQUFULEVBQVlFLENBQVosRUFBZTtFQUNYLFNBQVNFLENBQVQsR0FBYTtJQUNULEtBQUtZLFdBQUwsR0FBbUJoQixDQUFuQjtFQUNIOztFQUNETSxFQUFDLENBQUNOLENBQUQsRUFBSUUsQ0FBSixDQUFELEVBQ0FGLENBQUMsQ0FBQ2EsU0FBRixHQUFjLFNBQVNYLENBQVQsR0FBYU8sTUFBTSxDQUFDUSxNQUFQLENBQWNmLENBQWQsQ0FBYixJQUFpQ0UsQ0FBQyxDQUFDUyxTQUFGLEdBQWNYLENBQUMsQ0FBQ1csU0FBaEIsRUFBMkIsSUFBSVQsQ0FBSixFQUE1RCxDQURkO0FBRUgsQ0FsQlUsQ0FBWDs7QUFtQkFLLE1BQU0sQ0FBQ1MsY0FBUCxDQUFzQmQsQ0FBdEIsRUFBeUIsWUFBekIsRUFBdUM7RUFDbkNlLEtBQUssRUFBRSxDQUFDO0FBRDJCLENBQXZDLEdBR0FmLENBQUMsQ0FBQ2dCLFFBQUYsR0FBYSxLQUFLLENBSGxCOztBQUlBLElBQUlDLENBQUMsR0FBR3JCLENBQUMsQ0FBQyxRQUFELENBQVQ7QUFBQSxJQUNBc0IsQ0FBQyxHQUFHdEIsQ0FBQyxDQUFDLFNBQUQsQ0FETDtBQUFBLElBRUF1QixDQUFDLEdBQUd2QixDQUFDLENBQUMsWUFBRCxDQUZMO0FBQUEsSUFHQXdCLENBQUMsR0FBR3hCLENBQUMsQ0FBQyxRQUFELENBSEw7QUFBQSxJQUlBeUIsQ0FBQyxHQUFHekIsQ0FBQyxDQUFDLGFBQUQsQ0FKTDtBQUFBLElBS0EwQixDQUFDLEdBQUcsVUFBUzFCLENBQVQsRUFBWTtFQUNaLFNBQVNFLENBQVQsR0FBYTtJQUNULElBQUlBLENBQUMsR0FBR0YsQ0FBQyxDQUFDZSxJQUFGLENBQU8sSUFBUCxLQUFnQixJQUF4QjtJQUNBLE9BQU9iLENBQUMsQ0FBQ3lCLGNBQUYsR0FBbUIsSUFBSUMsR0FBSixFQUFuQixFQUNQMUIsQ0FBQyxDQUFDMkIsWUFBRixHQUFpQixJQUFJRCxHQUFKLEVBRFYsRUFFUDFCLENBQUMsQ0FBQzRCLE1BQUYsR0FBVyxFQUZKLEVBR1A1QixDQUFDLENBQUM2QixXQUFGLEdBQWdCLEVBSFQsRUFJUDdCLENBQUMsQ0FBQzhCLFNBQUYsR0FBYyxFQUpQLEVBS1A5QixDQUxBO0VBTUg7O0VBQ0QsT0FBT0ssQ0FBQyxDQUFDTCxDQUFELEVBQUlGLENBQUosQ0FBRCxFQUNQRSxDQUFDLENBQUMrQixXQUFGLEdBQWdCLFlBQVc7SUFDdkIsT0FBTyxRQUFRLEtBQUtDLFFBQWIsS0FBMEIsS0FBS0EsUUFBTCxHQUFnQixJQUFJaEMsQ0FBSixFQUExQyxHQUNQLEtBQUtnQyxRQURMO0VBRUgsQ0FKTSxFQUtQaEMsQ0FBQyxDQUFDVyxTQUFGLENBQVlzQixJQUFaLEdBQW1CLFVBQVNuQyxDQUFULEVBQVk7SUFDM0IsS0FBSzhCLE1BQUwsR0FBYzlCLENBQWQsRUFDQSxLQUFLb0MsbUJBQUwsQ0FBeUJmLENBQUMsQ0FBQ2dCLE9BQUYsQ0FBVUMsUUFBbkMsQ0FEQTtFQUVILENBUk0sRUFTUHBDLENBQUMsQ0FBQ1csU0FBRixDQUFZMEIsU0FBWixHQUF3QixVQUFTdkMsQ0FBVCxFQUFZRSxDQUFaLEVBQWU7SUFDbkMsSUFBSUUsQ0FBQyxHQUFHLElBQVI7SUFBQSxJQUNBRSxDQUFDLEdBQUcsS0FBS2tDLFNBQUwsQ0FBZXhDLENBQWYsQ0FESjtJQUVBTSxDQUFDLEdBQUdtQixDQUFDLENBQUNnQixXQUFGLENBQWNSLFdBQWQsR0FBNEJTLE9BQTVCLENBQW9DcEMsQ0FBQyxDQUFDcUMsTUFBdEMsRUFBOENyQyxDQUFDLENBQUNzQyxJQUFoRCxFQUFzREMsRUFBRSxDQUFDQyxTQUF6RCxFQUNKLFVBQVM5QyxDQUFULEVBQVk7TUFDUkksQ0FBQyxDQUFDeUIsWUFBRixDQUFla0IsR0FBZixDQUFtQnpDLENBQUMsQ0FBQ3NDLElBQXJCLEVBQTJCNUMsQ0FBM0IsR0FDQUUsQ0FBQyxJQUFJQSxDQUFDLEVBRE47SUFFSCxDQUpHLENBQUgsR0FJSXNCLENBQUMsQ0FBQ3dCLE1BQUYsQ0FBU2YsV0FBVCxHQUF1QmdCLEtBQXZCLENBQTZCLFNBQTdCLEVBQXdDakQsQ0FBeEMsQ0FKTDtFQUtILENBakJNLEVBa0JQRSxDQUFDLENBQUNXLFNBQUYsQ0FBWXFDLFNBQVosR0FBd0IsVUFBU2xELENBQVQsRUFBWTtJQUNoQyxLQUFLK0IsV0FBTCxDQUFpQm9CLElBQWpCLENBQXNCbkQsQ0FBdEI7RUFDSCxDQXBCTSxFQXFCUEUsQ0FBQyxDQUFDVyxTQUFGLENBQVkyQixTQUFaLEdBQXdCLFVBQVN4QyxDQUFULEVBQVk7SUFDaEMsSUFBSUUsQ0FBQyxHQUFHLEtBQUs0QixNQUFMLENBQVk5QixDQUFaLENBQVI7SUFDQSxJQUFJRSxDQUFKLEVBQU8sT0FBT0EsQ0FBUDs7SUFDUCxLQUFLLElBQUlFLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUcsS0FBSzJCLFdBQUwsQ0FBaUJxQixNQUFyQyxFQUE2Q2hELENBQUMsRUFBOUMsRUFBa0Q7TUFDOUMsSUFBSUUsQ0FBQyxHQUFHLEtBQUt5QixXQUFMLENBQWlCM0IsQ0FBakIsRUFBb0JKLENBQXBCLENBQVI7TUFDQSxJQUFJTSxDQUFKLEVBQU8sT0FBT0EsQ0FBUDtJQUNWOztJQUNELE9BQU8sSUFBUDtFQUNILENBN0JNLEVBOEJQSixDQUFDLENBQUNXLFNBQUYsQ0FBWXdDLFdBQVosR0FBMEIsVUFBU3JELENBQVQsRUFBWTtJQUNsQyxLQUFLLElBQUlFLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUcsS0FBSzhCLFNBQUwsQ0FBZW9CLE1BQW5DLEVBQTJDbEQsQ0FBQyxFQUE1QztNQUFnRCxJQUFJLEtBQUs4QixTQUFMLENBQWU5QixDQUFmLEtBQXFCRixDQUF6QixFQUE0QixPQUFPLENBQUUsQ0FBVDtJQUE1RTs7SUFDQSxPQUFPLEtBQUtnQyxTQUFMLENBQWVtQixJQUFmLENBQW9CbkQsQ0FBcEIsR0FDUCxDQUFDLENBREQ7RUFFSCxDQWxDTSxFQW1DUEUsQ0FBQyxDQUFDVyxTQUFGLENBQVl5QyxjQUFaLEdBQTZCLFVBQVN0RCxDQUFULEVBQVk7SUFDckMsS0FBSyxJQUFJRSxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUs4QixTQUFMLENBQWVvQixNQUFuQyxFQUEyQ2xELENBQUMsRUFBNUM7TUFBZ0QsSUFBSSxLQUFLOEIsU0FBTCxDQUFlOUIsQ0FBZixLQUFxQkYsQ0FBekIsRUFBNEIsT0FBTyxLQUFLZ0MsU0FBTCxDQUFldUIsTUFBZixDQUFzQnJELENBQXRCLEVBQXlCLENBQXpCLEdBQ25GLENBQUMsQ0FEMkU7SUFBNUU7O0lBRUEsT0FBTyxDQUFFLENBQVQ7RUFDSCxDQXZDTSxFQXdDUEEsQ0FBQyxDQUFDVyxTQUFGLENBQVkyQyxrQkFBWixHQUFpQyxVQUFTeEQsQ0FBVCxFQUFZO0lBQ3pDLElBQUlFLENBQUMsR0FBRyxJQUFJMkMsRUFBRSxDQUFDWSxXQUFQLEVBQVI7SUFDQSxPQUFPLEtBQUs5QixjQUFMLENBQW9CK0IsR0FBcEIsQ0FBd0IxRCxDQUF4QixLQUE4QixLQUFLMkIsY0FBTCxDQUFvQmdDLEdBQXBCLENBQXdCM0QsQ0FBeEIsRUFBMkI0RCxPQUEzQixFQUE5QixFQUNQLEtBQUtqQyxjQUFMLENBQW9Cb0IsR0FBcEIsQ0FBd0IvQyxDQUF4QixFQUEyQkUsQ0FBM0IsQ0FETyxFQUVQQSxDQUZBO0VBR0gsQ0E3Q00sRUE4Q1BBLENBQUMsQ0FBQ1csU0FBRixDQUFZZ0QsY0FBWixHQUE2QixVQUFTN0QsQ0FBVCxFQUFZO0lBQ3JDLE9BQU8sS0FBSzJCLGNBQUwsQ0FBb0IrQixHQUFwQixDQUF3QjFELENBQXhCLElBQTZCLEtBQUsyQixjQUFMLENBQW9CZ0MsR0FBcEIsQ0FBd0IzRCxDQUF4QixDQUE3QixHQUEwRCxLQUFLd0Qsa0JBQUwsQ0FBd0J4RCxDQUF4QixDQUFqRTtFQUNILENBaERNLEVBaURQRSxDQUFDLENBQUNXLFNBQUYsQ0FBWWlELFNBQVosR0FBd0IsVUFBUzlELENBQVQsRUFBWUUsQ0FBWixFQUFlRSxDQUFmLEVBQWtCRSxDQUFsQixFQUFxQjtJQUN6QyxJQUFJQyxDQUFDLEdBQUcsSUFBUjs7SUFDQSxJQUFJLEtBQUssQ0FBTCxLQUFXSCxDQUFYLEtBQWlCQSxDQUFDLEdBQUcsQ0FBQyxDQUF0QixHQUEwQixLQUFLLENBQUwsS0FBV0UsQ0FBWCxLQUFpQkEsQ0FBQyxHQUFHLENBQXJCLENBQTFCLEVBQW1EaUIsQ0FBQyxDQUFDd0MsVUFBRixDQUFhQyxZQUFiLEVBQXZELEVBQW9GO01BQ2hGLElBQUkzQyxDQUFDLEdBQUcsS0FBS3dDLGNBQUwsQ0FBb0IzRCxDQUFwQixDQUFSO01BQ0EsSUFBSSxRQUFRbUIsQ0FBWixFQUFlLE9BQU8sS0FBS0csQ0FBQyxDQUFDd0IsTUFBRixDQUFTZixXQUFULEdBQXVCZ0IsS0FBdkIsQ0FBNkIscUJBQXFCL0MsQ0FBckIsR0FBeUIsS0FBdEQsQ0FBWjtNQUNmbUIsQ0FBQyxDQUFDNEMsSUFBRjtNQUNBLElBQUkzQyxDQUFDLEdBQUcsS0FBS2tCLFNBQUwsQ0FBZXhDLENBQWYsQ0FBUjtNQUNBLElBQUksUUFBUXNCLENBQVosRUFBZSxPQUFPLEtBQUtFLENBQUMsQ0FBQ3dCLE1BQUYsQ0FBU2YsV0FBVCxHQUF1QmdCLEtBQXZCLENBQTZCLGNBQWNqRCxDQUFkLEdBQWtCLEtBQS9DLENBQVo7O01BQ2YsSUFBSUksQ0FBQyxJQUFJLEtBQUtpRCxXQUFMLENBQWlCbkQsQ0FBakIsQ0FBTCxFQUEwQixLQUFLMkIsWUFBTCxDQUFrQjZCLEdBQWxCLENBQXNCcEMsQ0FBQyxDQUFDc0IsSUFBeEIsQ0FBOUIsRUFBNkQ7UUFDekQsSUFBSWxCLENBQUMsR0FBRyxLQUFLRyxZQUFMLENBQWtCOEIsR0FBbEIsQ0FBc0JyQyxDQUFDLENBQUNzQixJQUF4QixDQUFSO1FBQ0F2QixDQUFDLENBQUM2QyxJQUFGLEdBQVN4QyxDQUFULEVBQ0FMLENBQUMsQ0FBQzhDLElBQUYsR0FBUy9ELENBRFQsRUFFQWlCLENBQUMsQ0FBQytDLE1BQUYsR0FBVzlELENBRlgsRUFHQWUsQ0FBQyxDQUFDZ0QsSUFBRixFQUhBO01BSUgsQ0FORCxNQU1PNUMsQ0FBQyxDQUFDZ0IsV0FBRixDQUFjUixXQUFkLEdBQTRCUyxPQUE1QixDQUFvQ3BCLENBQUMsQ0FBQ3FCLE1BQXRDLEVBQThDckIsQ0FBQyxDQUFDc0IsSUFBaEQsRUFBc0RDLEVBQUUsQ0FBQ0MsU0FBekQsRUFDUCxVQUFTOUMsQ0FBVCxFQUFZO1FBQ1JxQixDQUFDLENBQUM2QyxJQUFGLEdBQVNsRSxDQUFULEVBQ0FPLENBQUMsQ0FBQ3NCLFlBQUYsQ0FBZWtCLEdBQWYsQ0FBbUJ6QixDQUFDLENBQUNzQixJQUFyQixFQUEyQjVDLENBQTNCLENBREEsRUFFQXFCLENBQUMsQ0FBQzhDLElBQUYsR0FBUy9ELENBRlQsRUFHQWlCLENBQUMsQ0FBQytDLE1BQUYsR0FBVzlELENBSFgsRUFJQWUsQ0FBQyxDQUFDZ0QsSUFBRixFQUpBO01BS0gsQ0FQTTtJQVFWO0VBQ0osQ0F4RU0sRUF5RVBuRSxDQUFDLENBQUNXLFNBQUYsQ0FBWXlELFVBQVosR0FBeUIsVUFBU3RFLENBQVQsRUFBWTtJQUNqQyxJQUFJdUIsQ0FBQyxDQUFDd0MsVUFBRixDQUFhQyxZQUFiLEVBQUosRUFBaUM7TUFDN0IsSUFBSTlELENBQUMsR0FBRyxLQUFLMkQsY0FBTCxDQUFvQjdELENBQXBCLENBQVI7TUFDQSxJQUFJLFFBQVFFLENBQVosRUFBZSxPQUFPLEtBQUtzQixDQUFDLENBQUN3QixNQUFGLENBQVNmLFdBQVQsR0FBdUJnQixLQUF2QixDQUE2QixxQkFBcUJqRCxDQUFyQixHQUF5QixLQUF0RCxDQUFaO01BQ2ZFLENBQUMsQ0FBQ3FFLEtBQUY7SUFDSDtFQUNKLENBL0VNLEVBZ0ZQckUsQ0FBQyxDQUFDVyxTQUFGLENBQVkyRCxXQUFaLEdBQTBCLFVBQVN4RSxDQUFULEVBQVk7SUFDbEMsSUFBSXVCLENBQUMsQ0FBQ3dDLFVBQUYsQ0FBYUMsWUFBYixFQUFKLEVBQWlDO01BQzdCLElBQUk5RCxDQUFDLEdBQUcsS0FBSzJELGNBQUwsQ0FBb0I3RCxDQUFwQixDQUFSO01BQ0EsSUFBSSxRQUFRRSxDQUFaLEVBQWUsT0FBTyxLQUFLc0IsQ0FBQyxDQUFDd0IsTUFBRixDQUFTZixXQUFULEdBQXVCZ0IsS0FBdkIsQ0FBNkIscUJBQXFCakQsQ0FBckIsR0FBeUIsS0FBdEQsQ0FBWjtNQUNmRSxDQUFDLENBQUN1RSxNQUFGO0lBQ0g7RUFDSixDQXRGTSxFQXVGUHZFLENBQUMsQ0FBQ1csU0FBRixDQUFZNkQsYUFBWixHQUE0QixZQUFXO0lBQ25DLElBQUkxRSxDQUFDLEdBQUcsSUFBUjtJQUNBLEtBQUtnQyxTQUFMLENBQWUyQyxPQUFmLENBQXVCLFVBQVN6RSxDQUFULEVBQVk7TUFDL0JGLENBQUMsQ0FBQ3NFLFVBQUYsQ0FBYXBFLENBQWI7SUFDSCxDQUZEO0VBR0gsQ0E1Rk0sRUE2RlBBLENBQUMsQ0FBQ1csU0FBRixDQUFZK0QsY0FBWixHQUE2QixZQUFXO0lBQ3BDLElBQUk1RSxDQUFDLEdBQUcsSUFBUjtJQUNBLEtBQUtnQyxTQUFMLENBQWUyQyxPQUFmLENBQXVCLFVBQVN6RSxDQUFULEVBQVk7TUFDL0JGLENBQUMsQ0FBQ3dFLFdBQUYsQ0FBY3RFLENBQWQ7SUFDSCxDQUZEO0VBR0gsQ0FsR00sRUFtR1BBLENBQUMsQ0FBQ1csU0FBRixDQUFZZ0UsU0FBWixHQUF3QixVQUFTN0UsQ0FBVCxFQUFZO0lBQ2hDLElBQUlFLENBQUMsR0FBRyxLQUFLMkQsY0FBTCxDQUFvQjdELENBQXBCLENBQVI7SUFDQSxRQUFRRSxDQUFSLElBQWEsS0FBS29ELGNBQUwsQ0FBb0J0RCxDQUFwQixHQUF3QkUsQ0FBQyxDQUFDK0QsSUFBRixFQUFyQyxJQUFpRHpDLENBQUMsQ0FBQ3dCLE1BQUYsQ0FBU2YsV0FBVCxHQUF1QmdCLEtBQXZCLENBQTZCLHFCQUFxQmpELENBQXJCLEdBQXlCLEtBQXRELENBQWpEO0VBQ0gsQ0F0R00sRUF1R1BFLENBQUMsQ0FBQ1csU0FBRixDQUFZaUUsT0FBWixHQUFzQixZQUFXO0lBQzdCLEtBQUtuRCxjQUFMLENBQW9CZ0QsT0FBcEIsQ0FBNEIsVUFBUzNFLENBQVQsRUFBWTtNQUNwQ0EsQ0FBQyxDQUFDaUUsSUFBRjtJQUNILENBRkQ7RUFHSCxDQTNHTSxFQTRHUC9ELENBQUMsQ0FBQ1csU0FBRixDQUFZa0UsVUFBWixHQUF5QixVQUFTL0UsQ0FBVCxFQUFZRSxDQUFaLEVBQWU7SUFDcEMsSUFBSUUsQ0FBQyxHQUFHLElBQVI7O0lBQ0EsSUFBSSxLQUFLLENBQUwsS0FBV0YsQ0FBWCxLQUFpQkEsQ0FBQyxHQUFHLENBQXJCLEdBQXlCcUIsQ0FBQyxDQUFDd0MsVUFBRixDQUFhaUIsYUFBYixFQUE3QixFQUEyRDtNQUN2RCxJQUFJMUUsQ0FBQyxHQUFHLEtBQUsyRSxpQkFBYjtNQUNBLFFBQVEzRSxDQUFSLEtBQWNBLENBQUMsR0FBRyxLQUFLdUQsY0FBTCxDQUFvQixRQUFwQixDQUFsQjtNQUNBLElBQUl0RCxDQUFDLEdBQUcsS0FBS2lDLFNBQUwsQ0FBZXhDLENBQWYsQ0FBUjs7TUFDQSxJQUFJLEtBQUs2QixZQUFMLENBQWtCNkIsR0FBbEIsQ0FBc0JuRCxDQUFDLENBQUNxQyxJQUF4QixDQUFKLEVBQW1DO1FBQy9CLElBQUl2QixDQUFDLEdBQUcsS0FBS1EsWUFBTCxDQUFrQjhCLEdBQWxCLENBQXNCcEQsQ0FBQyxDQUFDcUMsSUFBeEIsQ0FBUjtRQUNBdEMsQ0FBQyxDQUFDNEQsSUFBRixHQUFTN0MsQ0FBVCxFQUNBZixDQUFDLENBQUM4RCxNQUFGLEdBQVdsRSxDQURYLEVBRUFJLENBQUMsQ0FBQytELElBQUYsRUFGQTtNQUdILENBTEQsTUFLTzVDLENBQUMsQ0FBQ2dCLFdBQUYsQ0FBY1IsV0FBZCxHQUE0QlMsT0FBNUIsQ0FBb0NuQyxDQUFDLENBQUNvQyxNQUF0QyxFQUE4Q3BDLENBQUMsQ0FBQ3FDLElBQWhELEVBQXNEQyxFQUFFLENBQUNDLFNBQXpELEVBQ1AsVUFBUzlDLENBQVQsRUFBWTtRQUNSSSxDQUFDLENBQUN5QixZQUFGLENBQWVrQixHQUFmLENBQW1CeEMsQ0FBQyxDQUFDcUMsSUFBckIsRUFBMkI1QyxDQUEzQixHQUNBTSxDQUFDLENBQUM0RCxJQUFGLEdBQVNsRSxDQURULEVBRUFNLENBQUMsQ0FBQzhELE1BQUYsR0FBV2xFLENBRlgsRUFHQUksQ0FBQyxDQUFDK0QsSUFBRixFQUhBO01BSUgsQ0FOTTtJQU9WO0VBQ0osQ0EvSE0sRUFnSVBuRSxDQUFDLENBQUNXLFNBQUYsQ0FBWXFFLGdCQUFaLEdBQStCLFVBQVNsRixDQUFULEVBQVlFLENBQVosRUFBZUUsQ0FBZixFQUFrQkUsQ0FBbEIsRUFBcUI7SUFDaEQsSUFBSUMsQ0FBQyxHQUFHLElBQVI7O0lBQ0EsSUFBSSxLQUFLLENBQUwsS0FBV0gsQ0FBWCxLQUFpQkEsQ0FBQyxHQUFHLENBQXJCLEdBQXlCLEtBQUssQ0FBTCxLQUFXRSxDQUFYLEtBQWlCQSxDQUFDLEdBQUcsQ0FBQyxDQUF0QixDQUF6QixFQUFtRGlCLENBQUMsQ0FBQ3dDLFVBQUYsQ0FBYWlCLGFBQWIsRUFBdkQsRUFBcUY7TUFDakYsSUFBSTNELENBQUMsR0FBRyxLQUFLNEQsaUJBQWI7O01BQ0EsSUFBSSxRQUFRNUQsQ0FBUixLQUFjQSxDQUFDLEdBQUcsS0FBS3dDLGNBQUwsQ0FBb0IzRCxDQUFwQixDQUFsQixHQUEyQyxLQUFLMkIsWUFBTCxDQUFrQjZCLEdBQWxCLENBQXNCMUQsQ0FBdEIsQ0FBL0MsRUFBeUU7UUFDckUsSUFBSXNCLENBQUMsR0FBRyxLQUFLTyxZQUFMLENBQWtCOEIsR0FBbEIsQ0FBc0IzRCxDQUF0QixDQUFSO1FBQ0FxQixDQUFDLENBQUM2QyxJQUFGLEdBQVM1QyxDQUFULEVBQ0FELENBQUMsQ0FBQytDLE1BQUYsR0FBV2hFLENBRFgsRUFFQWlCLENBQUMsQ0FBQzhDLElBQUYsR0FBUzdELENBRlQsRUFHQWUsQ0FBQyxDQUFDZ0QsSUFBRixFQUhBO01BSUgsQ0FORCxNQU1PNUMsQ0FBQyxDQUFDZ0IsV0FBRixDQUFjUixXQUFkLEdBQTRCUyxPQUE1QixDQUFvQyxPQUFwQyxFQUE2QzFDLENBQTdDLEVBQWdENkMsRUFBRSxDQUFDQyxTQUFuRCxFQUNQLFVBQVM1QyxDQUFULEVBQVk7UUFDUkssQ0FBQyxDQUFDc0IsWUFBRixDQUFla0IsR0FBZixDQUFtQi9DLENBQW5CLEVBQXNCRSxDQUF0QixHQUNBbUIsQ0FBQyxDQUFDNkMsSUFBRixHQUFTaEUsQ0FEVCxFQUVBbUIsQ0FBQyxDQUFDK0MsTUFBRixHQUFXaEUsQ0FGWCxFQUdBaUIsQ0FBQyxDQUFDOEMsSUFBRixHQUFTN0QsQ0FIVCxFQUlBZSxDQUFDLENBQUNnRCxJQUFGLEVBSkE7TUFLSCxDQVBNO0lBUVY7RUFDSixDQW5KTSxFQW9KUG5FLENBQUMsQ0FBQ1csU0FBRixDQUFZc0UsaUJBQVosR0FBZ0MsVUFBU25GLENBQVQsRUFBWUUsQ0FBWixFQUFlRSxDQUFmLEVBQWtCRSxDQUFsQixFQUFxQkMsQ0FBckIsRUFBd0I7SUFDcEQsSUFBSWMsQ0FBQyxHQUFHLElBQVI7O0lBQ0EsSUFBSUUsQ0FBQyxDQUFDd0MsVUFBRixDQUFhQyxZQUFiLEVBQUosRUFBaUM7TUFDN0IsSUFBSTFDLENBQUMsR0FBRyxLQUFLdUMsY0FBTCxDQUFvQnpELENBQXBCLENBQVI7TUFDQSxJQUFJLFFBQVFrQixDQUFaLEVBQWUsT0FBTyxLQUFLRSxDQUFDLENBQUN3QixNQUFGLENBQVNmLFdBQVQsR0FBdUJnQixLQUF2QixDQUE2QixxQkFBcUI3QyxDQUFyQixHQUF5QixLQUF0RCxDQUFaOztNQUNmLElBQUlrQixDQUFDLENBQUMyQyxJQUFGLElBQVUsS0FBS3BDLFlBQUwsQ0FBa0I2QixHQUFsQixDQUFzQnhELENBQXRCLENBQWQsRUFBd0M7UUFDcEMsSUFBSXdCLENBQUMsR0FBRyxLQUFLRyxZQUFMLENBQWtCOEIsR0FBbEIsQ0FBc0J6RCxDQUF0QixDQUFSO1FBQ0FvQixDQUFDLENBQUM0QyxJQUFGLEdBQVN4QyxDQUFULEVBQ0FKLENBQUMsQ0FBQzhDLE1BQUYsR0FBVyxDQURYLEVBRUE5RCxDQUFDLElBQUlnQixDQUFDLENBQUM2QyxJQUFGLEdBQVMsQ0FBQyxDQUFWLEVBQWEsS0FBS2QsV0FBTCxDQUFpQmpELENBQWpCLENBQWpCLElBQXdDa0IsQ0FBQyxDQUFDNkMsSUFBRixHQUFTLENBQUMsQ0FGbkQsRUFHQTdDLENBQUMsQ0FBQytDLElBQUYsRUFIQSxFQUlBOUQsQ0FBQyxJQUFJQSxDQUFDLENBQUNlLENBQUQsQ0FKTjtNQUtILENBUEQsTUFPT0csQ0FBQyxDQUFDZ0IsV0FBRixDQUFjUixXQUFkLEdBQTRCUyxPQUE1QixDQUFvQzFDLENBQXBDLEVBQXVDb0YsTUFBTSxDQUFDbEYsQ0FBRCxDQUE3QyxFQUFrRDJDLEVBQUUsQ0FBQ0MsU0FBckQsRUFDUCxVQUFTOUMsQ0FBVCxFQUFZO1FBQ1JzQixDQUFDLENBQUM0QyxJQUFGLEdBQVNsRSxDQUFULEVBQ0FxQixDQUFDLENBQUNRLFlBQUYsQ0FBZWtCLEdBQWYsQ0FBbUI3QyxDQUFuQixFQUFzQkYsQ0FBdEIsQ0FEQSxFQUVBc0IsQ0FBQyxDQUFDOEMsTUFBRixHQUFXLENBRlgsRUFHQTlELENBQUMsSUFBSWdCLENBQUMsQ0FBQzZDLElBQUYsR0FBUyxDQUFDLENBQVYsRUFBYTlDLENBQUMsQ0FBQ2dDLFdBQUYsQ0FBY2pELENBQWQsQ0FBakIsSUFBcUNrQixDQUFDLENBQUM2QyxJQUFGLEdBQVMsQ0FBQyxDQUhoRCxFQUlBN0MsQ0FBQyxDQUFDK0MsSUFBRixFQUpBLEVBS0E5RCxDQUFDLElBQUlBLENBQUMsQ0FBQ2UsQ0FBRCxDQUxOO01BTUgsQ0FSTTtJQVNWO0VBQ0osQ0ExS00sRUEyS1BwQixDQUFDLENBQUNXLFNBQUYsQ0FBWXdFLFVBQVosR0FBeUIsWUFBVztJQUNoQyxJQUFJckYsQ0FBQyxHQUFHLEtBQUs2RCxjQUFMLENBQW9CLFFBQXBCLENBQVI7SUFDQTdELENBQUMsSUFBSUEsQ0FBQyxDQUFDaUUsSUFBRixFQUFMO0VBQ0gsQ0E5S00sRUErS1AvRCxDQUFDLENBQUNXLFNBQUYsQ0FBWXVCLG1CQUFaLEdBQWtDLFVBQVNwQyxDQUFULEVBQVk7SUFDMUMsS0FBS3NGLGlCQUFMLEdBQXlCdEYsQ0FBekI7RUFDSCxDQWpMTSxFQWtMUEUsQ0FBQyxDQUFDVyxTQUFGLENBQVkwRSxzQkFBWixHQUFxQyxZQUFXO0lBQzVDLEtBQUtELGlCQUFMLElBQTBCLEtBQUtQLFVBQUwsQ0FBZ0IsS0FBS08saUJBQXJCLENBQTFCO0VBQ0gsQ0FwTE0sRUFxTFBwRixDQXJMQTtBQXNMSCxDQWhNRyxDQWdNRG9CLENBQUMsV0FoTUEsQ0FMSjs7QUFzTUFsQixDQUFDLENBQUNnQixRQUFGLEdBQWFNLENBQWIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciB0ID0gcmVxdWlyZTtcbnZhciBlID0gbW9kdWxlO1xudmFyIG8gPSBleHBvcnRzO1xudmFyIGEsIGkgPSB0aGlzICYmIHRoaXMuX19leHRlbmRzIHx8IChhID0gZnVuY3Rpb24odCwgZSkge1xuICAgIHJldHVybiAoYSA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7XG4gICAgICAgIF9fcHJvdG9fXzogW11cbiAgICB9XG4gICAgaW5zdGFuY2VvZiBBcnJheSAmJlxuICAgIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgdC5fX3Byb3RvX18gPSBlXG4gICAgfSB8fFxuICAgIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgZm9yICh2YXIgbyBpbiBlKSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSwgbykgJiYgKHRbb10gPSBlW29dKVxuICAgIH0pKHQsIGUpXG59LFxuZnVuY3Rpb24odCwgZSkge1xuICAgIGZ1bmN0aW9uIG8oKSB7XG4gICAgICAgIHRoaXMuY29uc3RydWN0b3IgPSB0XG4gICAgfVxuICAgIGEodCwgZSksXG4gICAgdC5wcm90b3R5cGUgPSBudWxsID09PSBlID8gT2JqZWN0LmNyZWF0ZShlKSA6IChvLnByb3RvdHlwZSA9IGUucHJvdG90eXBlLCBuZXcgbylcbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6ICEwXG59KSxcbm8uQXVkaW9NZ3IgPSB2b2lkIDA7XG52YXIgciA9IHQoXCJDb25maWdcIiksXG5uID0gdChcIkJhc2VNZ3JcIiksXG5zID0gdChcIkNhY2hlVXRpbHNcIiksXG5jID0gdChcIkxvZ01nclwiKSxcbmwgPSB0KFwiUmVzb3VyY2VNZ3JcIiksXG51ID0gZnVuY3Rpb24odCkge1xuICAgIGZ1bmN0aW9uIGUoKSB7XG4gICAgICAgIHZhciBlID0gdC5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIHJldHVybiBlLmF1ZGlvU291cmNlTWFwID0gbmV3IE1hcCxcbiAgICAgICAgZS5hdWRpb0NsaXBNYXAgPSBuZXcgTWFwLFxuICAgICAgICBlLkFEQ29uZiA9IHt9LFxuICAgICAgICBlLm90aGVyQURDb25mID0gW10sXG4gICAgICAgIGUubXVzaWNLZXlzID0gW10sXG4gICAgICAgIGVcbiAgICB9XG4gICAgcmV0dXJuIGkoZSwgdCksXG4gICAgZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbnVsbCA9PSB0aGlzLmluc3RhbmNlICYmICh0aGlzLmluc3RhbmNlID0gbmV3IGUpLFxuICAgICAgICB0aGlzLmluc3RhbmNlXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24odCkge1xuICAgICAgICB0aGlzLkFEQ29uZiA9IHQsXG4gICAgICAgIHRoaXMuc2V0QnV0dG9uTm9tYWxBdWRpbyhyLkF1ZGlvSWQuYnRuQ2xpY2spXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5sb2FkQXVkaW8gPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHZhciBvID0gdGhpcyxcbiAgICAgICAgYSA9IHRoaXMuZ2V0QWRDb25mKHQpO1xuICAgICAgICBhID8gbC5SZXNvdXJjZU1nci5nZXRJbnN0YW5jZSgpLmxvYWRSZXMoYS5idW5kbGUsIGEucGF0aCwgY2MuQXVkaW9DbGlwLFxuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBvLmF1ZGlvQ2xpcE1hcC5zZXQoYS5wYXRoLCB0KSxcbiAgICAgICAgICAgIGUgJiYgZSgpXG4gICAgICAgIH0pIDogYy5Mb2dNZ3IuZ2V0SW5zdGFuY2UoKS5lcnJvcihcIumfs+aViOayoeaciemFjee9ru+8mlwiLCB0KVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUuYWRkQWRDb25mID0gZnVuY3Rpb24odCkge1xuICAgICAgICB0aGlzLm90aGVyQURDb25mLnB1c2godClcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLmdldEFkQ29uZiA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzLkFEQ29uZlt0XTtcbiAgICAgICAgaWYgKGUpIHJldHVybiBlO1xuICAgICAgICBmb3IgKHZhciBvID0gMDsgbyA8IHRoaXMub3RoZXJBRENvbmYubGVuZ3RoOyBvKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gdGhpcy5vdGhlckFEQ29uZltvXVt0XTtcbiAgICAgICAgICAgIGlmIChhKSByZXR1cm4gYVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5hZGRNdXNpY0tleSA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0aGlzLm11c2ljS2V5cy5sZW5ndGg7IGUrKykgaWYgKHRoaXMubXVzaWNLZXlzW2VdID09IHQpIHJldHVybiAhIDE7XG4gICAgICAgIHJldHVybiB0aGlzLm11c2ljS2V5cy5wdXNoKHQpLFxuICAgICAgICAhMFxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUucmVtb3ZlTXVzaWNLZXkgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdGhpcy5tdXNpY0tleXMubGVuZ3RoOyBlKyspIGlmICh0aGlzLm11c2ljS2V5c1tlXSA9PSB0KSByZXR1cm4gdGhpcy5tdXNpY0tleXMuc3BsaWNlKGUsIDEpLFxuICAgICAgICAhMDtcbiAgICAgICAgcmV0dXJuICEgMVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUuY3JlYXRyZUF1ZGlvU291cmNlID0gZnVuY3Rpb24odCkge1xuICAgICAgICB2YXIgZSA9IG5ldyBjYy5BdWRpb1NvdXJjZTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXVkaW9Tb3VyY2VNYXAuaGFzKHQpICYmIHRoaXMuYXVkaW9Tb3VyY2VNYXAuZ2V0KHQpLmRlc3Ryb3koKSxcbiAgICAgICAgdGhpcy5hdWRpb1NvdXJjZU1hcC5zZXQodCwgZSksXG4gICAgICAgIGVcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLmdldEF1ZGlvU291cmNlID0gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdWRpb1NvdXJjZU1hcC5oYXModCkgPyB0aGlzLmF1ZGlvU291cmNlTWFwLmdldCh0KSA6IHRoaXMuY3JlYXRyZUF1ZGlvU291cmNlKHQpXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5wbGF5TXVzaWMgPSBmdW5jdGlvbih0LCBlLCBvLCBhKSB7XG4gICAgICAgIHZhciBpID0gdGhpcztcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gbyAmJiAobyA9ICEwKSwgdm9pZCAwID09PSBhICYmIChhID0gMSksIHMuQ2FjaGVVdGlscy5jYW5QbGF5TXVzaW4oKSkge1xuICAgICAgICAgICAgdmFyIHIgPSB0aGlzLmdldEF1ZGlvU291cmNlKGUpO1xuICAgICAgICAgICAgaWYgKG51bGwgPT0gcikgcmV0dXJuIHZvaWQgYy5Mb2dNZ3IuZ2V0SW5zdGFuY2UoKS5lcnJvcihcImF1ZGlvU291cmNlTmFtZe+8mlwiICsgZSArIFwi5LiN5a2Y5ZyoXCIpO1xuICAgICAgICAgICAgci5zdG9wKCk7XG4gICAgICAgICAgICB2YXIgbiA9IHRoaXMuZ2V0QWRDb25mKHQpO1xuICAgICAgICAgICAgaWYgKG51bGwgPT0gbikgcmV0dXJuIHZvaWQgYy5Mb2dNZ3IuZ2V0SW5zdGFuY2UoKS5lcnJvcihcImF1ZGlvIGlkOlwiICsgdCArIFwi5LiN5a2Y5ZyoXCIpO1xuICAgICAgICAgICAgaWYgKG8gJiYgdGhpcy5hZGRNdXNpY0tleShlKSwgdGhpcy5hdWRpb0NsaXBNYXAuaGFzKG4ucGF0aCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdSA9IHRoaXMuYXVkaW9DbGlwTWFwLmdldChuLnBhdGgpO1xuICAgICAgICAgICAgICAgIHIuY2xpcCA9IHUsXG4gICAgICAgICAgICAgICAgci5sb29wID0gbyxcbiAgICAgICAgICAgICAgICByLnZvbHVtZSA9IGEsXG4gICAgICAgICAgICAgICAgci5wbGF5KClcbiAgICAgICAgICAgIH0gZWxzZSBsLlJlc291cmNlTWdyLmdldEluc3RhbmNlKCkubG9hZFJlcyhuLmJ1bmRsZSwgbi5wYXRoLCBjYy5BdWRpb0NsaXAsXG4gICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgci5jbGlwID0gdCxcbiAgICAgICAgICAgICAgICBpLmF1ZGlvQ2xpcE1hcC5zZXQobi5wYXRoLCB0KSxcbiAgICAgICAgICAgICAgICByLmxvb3AgPSBvLFxuICAgICAgICAgICAgICAgIHIudm9sdW1lID0gYSxcbiAgICAgICAgICAgICAgICByLnBsYXkoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUucGF1c2VNdXNpYyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgaWYgKHMuQ2FjaGVVdGlscy5jYW5QbGF5TXVzaW4oKSkge1xuICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmdldEF1ZGlvU291cmNlKHQpO1xuICAgICAgICAgICAgaWYgKG51bGwgPT0gZSkgcmV0dXJuIHZvaWQgYy5Mb2dNZ3IuZ2V0SW5zdGFuY2UoKS5lcnJvcihcImF1ZGlvU291cmNlTmFtZe+8mlwiICsgdCArIFwi5LiN5a2Y5ZyoXCIpO1xuICAgICAgICAgICAgZS5wYXVzZSgpXG4gICAgICAgIH1cbiAgICB9LFxuICAgIGUucHJvdG90eXBlLnJlc3VtZU11c2ljID0gZnVuY3Rpb24odCkge1xuICAgICAgICBpZiAocy5DYWNoZVV0aWxzLmNhblBsYXlNdXNpbigpKSB7XG4gICAgICAgICAgICB2YXIgZSA9IHRoaXMuZ2V0QXVkaW9Tb3VyY2UodCk7XG4gICAgICAgICAgICBpZiAobnVsbCA9PSBlKSByZXR1cm4gdm9pZCBjLkxvZ01nci5nZXRJbnN0YW5jZSgpLmVycm9yKFwiYXVkaW9Tb3VyY2VOYW1l77yaXCIgKyB0ICsgXCLkuI3lrZjlnKhcIik7XG4gICAgICAgICAgICBlLnJlc3VtZSgpXG4gICAgICAgIH1cbiAgICB9LFxuICAgIGUucHJvdG90eXBlLnBhdXNlQWxsTXVzaWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICB0aGlzLm11c2ljS2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHQucGF1c2VNdXNpYyhlKVxuICAgICAgICB9KVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUucmVzdW1lQWxsTXVzaWMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICB0aGlzLm11c2ljS2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHQucmVzdW1lTXVzaWMoZSlcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLnN0b3BNdXNpYyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzLmdldEF1ZGlvU291cmNlKHQpO1xuICAgICAgICBudWxsICE9IGUgPyAodGhpcy5yZW1vdmVNdXNpY0tleSh0KSwgZS5zdG9wKCkpIDogYy5Mb2dNZ3IuZ2V0SW5zdGFuY2UoKS5lcnJvcihcImF1ZGlvU291cmNlTmFtZe+8mlwiICsgdCArIFwi5LiN5a2Y5ZyoXCIpXG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5zdG9wQWxsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYXVkaW9Tb3VyY2VNYXAuZm9yRWFjaChmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LnN0b3AoKVxuICAgICAgICB9KVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUucGxheUVmZmVjdCA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgdmFyIG8gPSB0aGlzO1xuICAgICAgICBpZiAodm9pZCAwID09PSBlICYmIChlID0gMSksIHMuQ2FjaGVVdGlscy5jYW5QbGF5RWZmZWN0KCkpIHtcbiAgICAgICAgICAgIHZhciBhID0gdGhpcy5FZmZlY3RBZHVpb1NvdXJjZTtcbiAgICAgICAgICAgIG51bGwgPT0gYSAmJiAoYSA9IHRoaXMuZ2V0QXVkaW9Tb3VyY2UoXCJlZmZlY3RcIikpO1xuICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmdldEFkQ29uZih0KTtcbiAgICAgICAgICAgIGlmICh0aGlzLmF1ZGlvQ2xpcE1hcC5oYXMoaS5wYXRoKSkge1xuICAgICAgICAgICAgICAgIHZhciByID0gdGhpcy5hdWRpb0NsaXBNYXAuZ2V0KGkucGF0aCk7XG4gICAgICAgICAgICAgICAgYS5jbGlwID0gcixcbiAgICAgICAgICAgICAgICBhLnZvbHVtZSA9IGUsXG4gICAgICAgICAgICAgICAgYS5wbGF5KClcbiAgICAgICAgICAgIH0gZWxzZSBsLlJlc291cmNlTWdyLmdldEluc3RhbmNlKCkubG9hZFJlcyhpLmJ1bmRsZSwgaS5wYXRoLCBjYy5BdWRpb0NsaXAsXG4gICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgby5hdWRpb0NsaXBNYXAuc2V0KGkucGF0aCwgdCksXG4gICAgICAgICAgICAgICAgYS5jbGlwID0gdCxcbiAgICAgICAgICAgICAgICBhLnZvbHVtZSA9IGUsXG4gICAgICAgICAgICAgICAgYS5wbGF5KClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9LFxuICAgIGUucHJvdG90eXBlLnBsYXlFZmZlY3RCeVBhdGggPSBmdW5jdGlvbih0LCBlLCBvLCBhKSB7XG4gICAgICAgIHZhciBpID0gdGhpcztcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gbyAmJiAobyA9IDEpLCB2b2lkIDAgPT09IGEgJiYgKGEgPSAhMSksIHMuQ2FjaGVVdGlscy5jYW5QbGF5RWZmZWN0KCkpIHtcbiAgICAgICAgICAgIHZhciByID0gdGhpcy5FZmZlY3RBZHVpb1NvdXJjZTtcbiAgICAgICAgICAgIGlmIChudWxsID09IHIgJiYgKHIgPSB0aGlzLmdldEF1ZGlvU291cmNlKGUpKSwgdGhpcy5hdWRpb0NsaXBNYXAuaGFzKHQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG4gPSB0aGlzLmF1ZGlvQ2xpcE1hcC5nZXQodCk7XG4gICAgICAgICAgICAgICAgci5jbGlwID0gbixcbiAgICAgICAgICAgICAgICByLnZvbHVtZSA9IG8sXG4gICAgICAgICAgICAgICAgci5sb29wID0gYSxcbiAgICAgICAgICAgICAgICByLnBsYXkoKVxuICAgICAgICAgICAgfSBlbHNlIGwuUmVzb3VyY2VNZ3IuZ2V0SW5zdGFuY2UoKS5sb2FkUmVzKFwiYXVkaW9cIiwgdCwgY2MuQXVkaW9DbGlwLFxuICAgICAgICAgICAgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIGkuYXVkaW9DbGlwTWFwLnNldCh0LCBlKSxcbiAgICAgICAgICAgICAgICByLmNsaXAgPSBlLFxuICAgICAgICAgICAgICAgIHIudm9sdW1lID0gbyxcbiAgICAgICAgICAgICAgICByLmxvb3AgPSBhLFxuICAgICAgICAgICAgICAgIHIucGxheSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5wbGF5QXVkaW9Gcm9tUGF0aCA9IGZ1bmN0aW9uKHQsIGUsIG8sIGEsIGkpIHtcbiAgICAgICAgdmFyIHIgPSB0aGlzO1xuICAgICAgICBpZiAocy5DYWNoZVV0aWxzLmNhblBsYXlNdXNpbigpKSB7XG4gICAgICAgICAgICB2YXIgbiA9IHRoaXMuZ2V0QXVkaW9Tb3VyY2Uobyk7XG4gICAgICAgICAgICBpZiAobnVsbCA9PSBuKSByZXR1cm4gdm9pZCBjLkxvZ01nci5nZXRJbnN0YW5jZSgpLmVycm9yKFwiYXVkaW9Tb3VyY2VOYW1l77yaXCIgKyBvICsgXCLkuI3lrZjlnKhcIik7XG4gICAgICAgICAgICBpZiAobi5zdG9wKCksIHRoaXMuYXVkaW9DbGlwTWFwLmhhcyhlKSkge1xuICAgICAgICAgICAgICAgIHZhciB1ID0gdGhpcy5hdWRpb0NsaXBNYXAuZ2V0KGUpO1xuICAgICAgICAgICAgICAgIG4uY2xpcCA9IHUsXG4gICAgICAgICAgICAgICAgbi52b2x1bWUgPSAxLFxuICAgICAgICAgICAgICAgIGEgPyAobi5sb29wID0gITAsIHRoaXMuYWRkTXVzaWNLZXkobykpIDogbi5sb29wID0gITEsXG4gICAgICAgICAgICAgICAgbi5wbGF5KCksXG4gICAgICAgICAgICAgICAgaSAmJiBpKG4pXG4gICAgICAgICAgICB9IGVsc2UgbC5SZXNvdXJjZU1nci5nZXRJbnN0YW5jZSgpLmxvYWRSZXModCwgU3RyaW5nKGUpLCBjYy5BdWRpb0NsaXAsXG4gICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgbi5jbGlwID0gdCxcbiAgICAgICAgICAgICAgICByLmF1ZGlvQ2xpcE1hcC5zZXQoZSwgdCksXG4gICAgICAgICAgICAgICAgbi52b2x1bWUgPSAxLFxuICAgICAgICAgICAgICAgIGEgPyAobi5sb29wID0gITAsIHIuYWRkTXVzaWNLZXkobykpIDogbi5sb29wID0gITEsXG4gICAgICAgICAgICAgICAgbi5wbGF5KCksXG4gICAgICAgICAgICAgICAgaSAmJiBpKG4pXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfSxcbiAgICBlLnByb3RvdHlwZS5zdG9wRWZmZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0ID0gdGhpcy5nZXRBdWRpb1NvdXJjZShcImVmZmVjdFwiKTtcbiAgICAgICAgdCAmJiB0LnN0b3AoKVxuICAgIH0sXG4gICAgZS5wcm90b3R5cGUuc2V0QnV0dG9uTm9tYWxBdWRpbyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgdGhpcy5ub3JtYWxCdXR0b25BdWRpbyA9IHRcbiAgICB9LFxuICAgIGUucHJvdG90eXBlLnBsYXlBdWRpb0J1dHRvbkNsaWNrZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5ub3JtYWxCdXR0b25BdWRpbyAmJiB0aGlzLnBsYXlFZmZlY3QodGhpcy5ub3JtYWxCdXR0b25BdWRpbylcbiAgICB9LFxuICAgIGVcbn0gKG4uZGVmYXVsdCk7XG5vLkF1ZGlvTWdyID0gdSJdfQ==