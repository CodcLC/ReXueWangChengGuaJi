{"version":3,"sources":["assets\\scripts\\ResCacheMgr.js"],"names":["t","require","e","module","o","exports","a","i","__extends","Object","setPrototypeOf","__proto__","Array","prototype","hasOwnProperty","call","constructor","create","defineProperty","value","ResCacheMgr","r","n","s","c","l","temporaryCache","permanentCache","isStartDecRef","assetsLifeTime","permanentCacheKeyMap","Map","depsdeps","getInstance","instance","init","startDecRef","UIUtils","schedule","autoRelease","TimeUtils","GetTimeBySecond","length","releaseTime","cacheTime","defCount","asset","decRef","refCount","splice","refreshTime","cachekey","type","canRelease","addAssets","isExistKey","push","addAssetKeyToMap","get","ResCacheKey","set","releaseAssetsFromMap","getAssets","cc","js","getClassName","u","p","g","createTime","visitAsset","_uuid","SpriteFrame","_original","_texture","getTexture","visitComponent","getOwnPropertyNames","NodePool","visitNodePool","isArray","Asset","visitNode","_components","_children","_pool"],"mappings":"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","sourceRoot":"/","sourcesContent":["var t = require;\nvar e = module;\nvar o = exports;\nvar a, i = this && this.__extends || (a = function(t, e) {\n    return (a = Object.setPrototypeOf || {\n        __proto__: []\n    }\n    instanceof Array &&\n    function(t, e) {\n        t.__proto__ = e\n    } ||\n    function(t, e) {\n        for (var o in e) Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o])\n    })(t, e)\n},\nfunction(t, e) {\n    function o() {\n        this.constructor = t\n    }\n    a(t, e),\n    t.prototype = null === e ? Object.create(e) : (o.prototype = e.prototype, new o)\n});\nObject.defineProperty(o, \"__esModule\", {\n    value: !0\n}),\no.ResCacheMgr = void 0;\nvar r = t(\"BaseMgr\"),\nn = t(\"TimeUtils\"),\ns = t(\"UIUtils\"),\nc = t(\"ResourceMgr\"),\nl = function(t) {\n    function e() {\n        var e = t.call(this) || this;\n        return e.temporaryCache = [],\n        e.permanentCache = [],\n        e.isStartDecRef = !1,\n        e.assetsLifeTime = 5,\n        e.permanentCacheKeyMap = new Map,\n        e.depsdeps = [],\n        e\n    }\n    return i(e, t),\n    e.getInstance = function() {\n        return null == this.instance && (this.instance = new e),\n        this.instance\n    },\n    e.prototype.init = function() {\n        this.startDecRef()\n    },\n    e.prototype.startDecRef = function() {\n        this.isStartDecRef || (this.isStartDecRef = !0, s.UIUtils.schedule(this.autoRelease, this, 1))\n    },\n    e.prototype.autoRelease = function() {\n        for (var t = n.TimeUtils.GetTimeBySecond(), e = 0; e < this.temporaryCache.length; e++) {\n            var o = this.temporaryCache[e];\n            if (o && t - o.releaseTime >= o.cacheTime) {\n                if (o.defCount <= 0) continue;\n                for (var a = o.defCount,\n                i = 0; i < a; i++) if (o.asset.decRef(), o.asset.refCount <= 0) {\n                    this.temporaryCache.splice(e, 1),\n                    e--,\n                    o.defCount = 0;\n                    break\n                }\n                o.asset.refCount > 0 && (o.releaseTime = n.TimeUtils.GetTimeBySecond() + 86400)\n            } else o && 0 == o.asset.refCount && (this.temporaryCache.splice(e, 1), e--, o.defCount = 0)\n        }\n    },\n    e.prototype.refreshTime = function(t) {\n        for (var e = n.TimeUtils.GetTimeBySecond(), o = 0; o < t.length; o++) for (var a = 0; a < this.temporaryCache.length; a++) {\n            var i = t[o],\n            r = this.temporaryCache[a];\n            if (i.cachekey == r.cachekey && i.type == r.type) {\n                this.temporaryCache[a].releaseTime = e,\n                this.temporaryCache[a].defCount += i.defCount,\n                this.temporaryCache[a].canRelease = !1;\n                break\n            }\n        }\n    },\n    e.prototype.addAssets = function(t, e) {\n        if (t && t.asset) {\n            var o = e ? this.temporaryCache: this.permanentCache,\n            a = this.isExistKey(t.cachekey, t.type, o); - 1 == a ? o.push(t) : o[a] = t\n        }\n    },\n    e.prototype.addAssetKeyToMap = function(t, e, o, a) {\n        var i = this.permanentCacheKeyMap.get(t),\n        r = new c.ResCacheKey(e, o, a);\n        if (i && i.length > 0) i.push(r);\n        else {\n            var n = [];\n            n.push(r),\n            this.permanentCacheKeyMap.set(t, n)\n        }\n    },\n    e.prototype.releaseAssetsFromMap = function(t) {\n        var e = this.permanentCacheKeyMap.get(t);\n        if (e && e.length > 0) for (var o = 0; o < e.length; o++) for (var a = 0; a < this.permanentCache.length; a++) {\n            var i = this.permanentCache[a];\n            if (i && i.cachekey == e[o].cachekey && i.type == e[o].type) {\n                i.asset.decRef(),\n                i.asset.refCount <= 0 && (this.permanentCache.splice(a, 1), a--);\n                break\n            }\n        }\n    },\n    e.prototype.getAssets = function(t, e, o) {\n        var a = \"\";\n        o && (a = cc.js.getClassName(o));\n        var i, r = n.TimeUtils.GetTimeBySecond(),\n        s = r + 86400,\n        c = t + \"/\" + e,\n        l = this.isExistKey(c, a, this.temporaryCache),\n        u = this.isExistKey(c, a, this.permanentCache),\n        p = null,\n        g = null;\n        return - 1 != l && (this.temporaryCache[l].releaseTime = s, this.temporaryCache[l].createTime = r, this.temporaryCache[l].canRelease = !0, (i = this.temporaryCache[l].asset) && i.refCount > 0 && (p = this.temporaryCache[l])),\n        -1 != u && (this.permanentCache[u].releaseTime = s, this.permanentCache[u].createTime = r, this.permanentCache[u].canRelease = !0, (i = this.permanentCache[u].asset) && i.refCount > 0 && (g = this.permanentCache[u])),\n        p || g || null\n    },\n    e.prototype.isExistKey = function(t, e, o) {\n        for (var a = 0; a < o.length; a++) {\n            var i = o[a];\n            if (i && i.cachekey == t && i.type == e) return a\n        }\n        return - 1\n    },\n    e.prototype.visitAsset = function(t, e) {\n        if (t._uuid) e.push(t._uuid);\n        else if (t instanceof cc.SpriteFrame) {\n            var o, a = t;\n            a._original ? (o = a._original._texture) && e.push(o._uuid) : (o = a.getTexture()) && e.push(o._uuid)\n        }\n    },\n    e.prototype.visitComponent = function(t, e) {\n        for (var o = Object.getOwnPropertyNames(t), a = 0; a < o.length; a++) {\n            var i = o[a];\n            if (\"node\" !== i && \"__eventTargets\" !== i) {\n                var r = t[i];\n                if (r instanceof cc.NodePool) this.visitNodePool(r, e);\n                else if (\"object\" == typeof r && r) if (Array.isArray(r)) for (var n = 0; n < r.length; n++)(c = r[n]) instanceof cc.Asset && this.visitAsset(c, e);\n                else if (r.constructor && r.constructor !== Object) r instanceof cc.Asset && this.visitAsset(r, e);\n                else {\n                    var s = Object.getOwnPropertyNames(r);\n                    for (n = 0; n < s.length; n++) {\n                        var c; (c = r[s[n]]) instanceof cc.Asset && this.visitAsset(c, e)\n                    }\n                }\n            }\n        }\n    },\n    e.prototype.visitNode = function(t, e) {\n        for (var o = 0; o < t._components.length; o++) this.visitComponent(t._components[o], e);\n        for (o = 0; o < t._children.length; o++) this.visitNode(t._children[o], e)\n    },\n    e.prototype.visitNodePool = function(t, e) {\n        for (var o = t._pool,\n        a = 0; a < o.length; a++) {\n            var i = o[a];\n            this.visitNode(i, e)\n        }\n    },\n    e.instance = null,\n    e\n} (r.default);\no.ResCacheMgr = l"]}